### YamlMime:PowershellCmdlet
summary: |-
  Modifies parameters for a site-to-site (S2S) interface.
module: RemoteAccess
notes: ""
inputs:
- name: <xref href="None" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="Microsoft.Management.Infrastructure.CimInstance#VpnS2SInterface" data-throw-if-not-resolved="False" />
  description: |-
    The `Microsoft.Management.Infrastructure.CimInstance` object is a wrapper class that displays Windows Management Instrumentation (WMI) objects.
    The path after the pound sign (`#`) provides the namespace and class name for the underlying WMI object.
links:
- text: Add-VpnS2SInterface
  href: ./Add-VpnS2SInterface.yml
- text: Clear-VpnS2SInterfaceStatistics
  href: ./Clear-VpnS2SInterfaceStatistics.yml
- text: Connect-VpnS2SInterface
  href: ./Connect-VpnS2SInterface.yml
- text: Disconnect-VpnS2SInterface
  href: ./Disconnect-VpnS2SInterface.yml
- text: Get-VpnAuthProtocol
  href: ./Get-VpnAuthProtocol.yml
- text: Get-VpnS2SInterface
  href: ./Get-VpnS2SInterface.yml
- text: Get-VpnS2SInterfaceStatistics
  href: ./Get-VpnS2SInterfaceStatistics.yml
- text: Get-VpnServerIPsecConfiguration
  href: ./Get-VpnServerIPsecConfiguration.yml
- text: Remove-VpnS2SInterface
  href: ./Remove-VpnS2SInterface.yml
- text: Set-VpnAuthProtocol
  href: ./Set-VpnAuthProtocol.yml
- text: Set-VpnServerIPsecConfiguration
  href: ./Set-VpnServerIPsecConfiguration.yml
syntaxes:
- >-
  Set-VpnS2SInterface [-Name] <String> [-AdminStatus <Boolean>] [-AsJob] [-AuthenticationMethod <String>]

   [-Certificate <X509Certificate2>] [-CimSession <CimSession[]>] [-Destination <String[]>] [-EapMethod <String>]

   [-EncryptionType <String>] [-IdleDisconnectSeconds <UInt32>] [-InternalIPv4 <Boolean>]

   [-InternalIPv6 <Boolean>] [-IPv4Subnet <String[]>] [-IPv6Subnet <String[]>]

   [-NetworkOutageTimeSeconds <UInt32>] [-NumberOfTries <UInt32>] [-PassThru] [-Password <String>]

   [-PromoteAlternate <Boolean>] [-ResponderAuthenticationMethod <String>] [-RetryIntervalSeconds <UInt32>]

   [-SADataSizeForRenegotiationKilobytes <UInt32>] [-SALifeTimeSeconds <UInt32>] [-SharedSecret <String>]

   [-ThrottleLimit <Int32>] [-UserName <String>] [-Confirm] [-WhatIf]
- >-
  Set-VpnS2SInterface [-Name] <String> [-AdminStatus <Boolean>] [-AsJob] [-AuthenticationMethod <String>]

   [-AuthenticationTransformConstants <AuthenticationTransformConstants>] [-Certificate <X509Certificate2>]

   [-CimSession <CimSession[]>] [-CipherTransformConstants <CipherTransformConstants>] [-Destination <String[]>]

   [-DHGroup <DHGroup>] [-EapMethod <String>] [-EncryptionMethod <EncryptionMethod>]

   [-IdleDisconnectSeconds <UInt32>] [-IntegrityCheckMethod <IntegrityCheckMethod>] [-InternalIPv4 <Boolean>]

   [-InternalIPv6 <Boolean>] [-IPv4Subnet <String[]>] [-IPv6Subnet <String[]>]

   [-NetworkOutageTimeSeconds <UInt32>] [-NumberOfTries <UInt32>] [-PassThru] [-Password <String>]

   [-PfsGroup <PfsGroup>] [-PromoteAlternate <Boolean>] [-ResponderAuthenticationMethod <String>]

   [-RetryIntervalSeconds <UInt32>] [-SADataSizeForRenegotiationKilobytes <UInt32>] [-SALifeTimeSeconds <UInt32>]

   [-SharedSecret <String>] [-ThrottleLimit <Int32>] [-UserName <String>] [-CustomPolicy] [-Confirm] [-WhatIf]
examples:
- title: EXAMPLE 1
  code: |-
    PS C:\> Set-VpnS2SInterface -Name edge1 -Destination 131.107.0.4 -PassThru
    Name                 Destination          AdminStatus  ConnectionState IPv4Subnet 
    ----                 -----------          -----------  --------------- ---------- 
    edge1                {131.107.0.4}        True         Disconnected    {10.0.0.0/24:100}
  description: |-
    This example modifies the destination address for the interface named edge1.
  summary: ""
- title: EXAMPLE 2
  code: |-
    PS C:\>Set-VpnS2SInterface -Name edge1 -AuthenticationMethod EAP -EapMethod EAP-MSCHAPv2 -PassThru
    Name                 Destination          AdminStatus  ConnectionState IPv4Subnet 
    ----                 -----------          -----------  --------------- ---------- 
    EDGE1                {131.107.0.4}        True         Disconnected    {10.0.0.0/24:100}
  description: |-
    This example modifies the initiator authentication method.
  summary: ""
- title: EXAMPLE 3
  code: |-
    PS C:\>Get-VpnS2SInterface -Name edge1 | Set-VpnS2SInterface -ResponderAuthenticationMethod MachineCertificates -PassThru
    Name                 Destination          AdminStatus  ConnectionState IPv4Subnet 
    ----                 -----------          -----------  --------------- ---------- 
    EDGE1                {131.107.0.4}        True         Disconnected    {10.0.0.0/24:100}
  description: |-
    This example modifies the responder authentication method for edge1.
  summary: ""
- title: EXAMPLE 4
  code: |-
    PS C:\>$cert1 = ( Get-ChildItem -Path cert:LocalMachine\My | Where-Object -FilterScript { $_.Subject -Like "*CN=edge1.contoso.com" } )



    PS C:\>Set-VpnS2SInterface -Name 3-edge1 -AuthenticationMethod MachineCertificates -Certificate $cert1 -ResponderAuthenticationMethod MachineCertificates -PassThru
    Name                 Destination          AdminStatus  ConnectionState IPv4Subnet 
    ----                 -----------          -----------  --------------- ---------- 
    3-edge1              {131.107.0.30}       True         Disconnected    {10.6.0.0/24:2}
  description: |-
    This example changes the authentication method for the interface 3-edge1 to computer certificate and specifies the certificate for which the subject name matches edge1.contoso.com.
  summary: ""
parameters:
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: AdminStatus
  description: |+
    Specifies the administrator status of the cmdlet.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsJob
  description: |+
    ps_cimcommon_asjob

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: AuthenticationMethod
  description: |+
    Specifies the authentication method to be used by the S2S connection.

  defaultValue: EAP
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="AuthenticationTransformConstants" data-throw-if-not-resolved="False" />
  name: AuthenticationTransformConstants
  description: |+
    Specifies the authentication transform in the IPsec policy.

  defaultValue: "2"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="X509Certificate2" data-throw-if-not-resolved="False" />
  name: Certificate
  description: |+
    Specifies the subject name of the certificate to use in the default store.
    Applicable only if the **AuthenticationMethod** parameter is set to MachineCert.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="CimSession" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: CimSession
  description: |+
    Runs the cmdlet in a remote session or on a remote computer.
    Enter a computer name or a session object, such as the output of a New-CimSessionhttp://go.microsoft.com/fwlink/p/?LinkId=227967 or Get-CimSessionhttp://go.microsoft.com/fwlink/p/?LinkId=227966 cmdlet.
    The default is the current session on the local computer.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="CipherTransformConstants" data-throw-if-not-resolved="False" />
  name: CipherTransformConstants
  description: |+
    Specifies the cipher in the IPsec policy.

  defaultValue: "1"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: "False"
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: CustomPolicy
  isRequired: true
  description: |+
    Specifies the custom IKE IPsec policies, must be a separate parameter set.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: Destination
  description: |+
    Specifies the destination end point of the S2S connection. 
    Note: If the **Certificate** parameter is specified as PSK, then an IP address should be specified for this parameter as a fully qualified domain name (FQDN) will not work.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="DHGroup" data-throw-if-not-resolved="False" />
  name: DHGroup
  description: |+
    Specifies the Diffie-Hellman (DH) group in the IPsec policy.

  defaultValue: "2"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: EapMethod
  description: |+
    Specifies the EAP method if IkeLocalAuthenticationMethod is EAP.

  defaultValue: MSCHAPv2
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="EncryptionMethod" data-throw-if-not-resolved="False" />
  name: EncryptionMethod
  description: |+
    Specifies the encryption method in the IKE policy.

  defaultValue: "4"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: EncryptionType
  description: |+
    Specifies the type of encryption.

  defaultValue: RequireEncryption
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: IdleDisconnectSeconds
  description: |+
    Specifies the time, in seconds, after which an idle connection is disconnected.
    Unless the idle time-out is Disabled, the entire connection is disconnected if the connection is idle for the specified interval.

  defaultValue: "300"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="IntegrityCheckMethod" data-throw-if-not-resolved="False" />
  name: IntegrityCheckMethod
  description: |+
    Specifies the integrity method in the IPsec policy.

  defaultValue: "2"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: InternalIPv4
  description: |+
    Specifies that the IPv4 address should be negotiated.

  defaultValue: "True"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: InternalIPv6
  description: |+
    Specifies that the IPv6 address should be negotiated.

  defaultValue: "True"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: IPv4Subnet
  description: |+
    Specifies the IPv4 subnet that is routed on this connection with metrics.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: IPv6Subnet
  description: |+
    Specifies the IPv6 subnet that is routed on this connection with metrics.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Name
  isRequired: true
  description: |+
    Specifies the name of the connection.

  defaultValue: None
  pipelineInput: true
  position: "2"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: NetworkOutageTimeSeconds
  description: |+
    Specifies the maximum network outage time after which the connection is disconnected.

  defaultValue: "15"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: NumberOfTries
  description: |+
    Specifies the number of connection attempts. 

    If this parameter is specified as zero (0), then the connection is not retried if the first attempt fails.

  defaultValue: "3"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: PassThru
  description: |+
    Returns an object representing the item with which you are working.
    By default, this cmdlet does not generate any output.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Password
  description: |+
    Specifies the password for the user name to be used for the connection. 

    Applicable only if the **AuthenticationMethod** parameter is set to EAP.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="PfsGroup" data-throw-if-not-resolved="False" />
  name: PfsGroup
  description: |+
    Specifies the PFS group in the IPsec policy.

  defaultValue: "3"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: PromoteAlternate
  description: |+
    Specifies an alternate IP address that when it successfully connects becomes the primary IP address, and the current primary IP address is moved to the alternate list.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ResponderAuthenticationMethod
  description: |+
    Specifies the authentication method to be used by the S2S initiator to validate the S2S responder.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: RetryIntervalSeconds
  description: |+
    Specifies the time, in seconds, between retries.

  defaultValue: "60"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: SADataSizeForRenegotiationKilobytes
  description: |+
    Specifies the number of kilobytes that are allowed to transfer using a security association (SA).
    After the limit is reached, then the SA will be renegotiated.

  defaultValue: "10000"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: SALifeTimeSeconds
  description: |+
    Specifies the lifetime of a SA in seconds, after which the SA is no longer valid.

  defaultValue: "7200"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: SharedSecret
  description: |+
    Specifies the text of the shared secret to be used for the connection.
    This parameter is only applicable only if the **AuthenticationMethod** parameter is set to PSK or the **ResponderAuthenticationMethod** parameter is set to PSK.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: ThrottleLimit
  description: |+
    Specifies the maximum number of concurrent operations that can be established to run the cmdlet.
    If this parameter is omitted or a value of `0` is entered, then Windows PowerShellÂ® calculates an optimum throttle limit for the cmdlet based on the number of CIM cmdlets that are running on the computer.
    The throttle limit applies only to the current cmdlet, not to the session or to the computer.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: UserName
  description: |+
    Specifies the user name to be used for the connection.
    Applicable only if the **AuthenticationMethod** parameter is set to EAP.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs.
    The cmdlet is not run.

  defaultValue: "False"
  position: Named
  aliases: ""
  parameterValueGroup: ""
uid: RemoteAccess.Set-VpnS2SInterface
name: Set-VpnS2SInterface
description: |-
  The **Set-VpnS2SInterface** cmdlet modifies parameters for a site-to-site (S2S) interface.
  If the connection already exists, then the changes take effect after disconnection.

  Use the **CustomPolicy** parameter to customize IPsec settings.
  If the protocol is Automatic, then the only authentication method allowed is user name.
  If the **AuthenticationMethod** parameter is set to pre-shared key (PSK), then only one interface can be enabled per destination and the initiator and responder policies are governed by what is specified for each interface.
  If the **AuthenticationMethod** parameter is set to user name or computer certificates (machine certificates), then only the initiator policies are governed by what is specified for each interface and the responder policies are governed by what is specified on the server.

  For incoming connections. 

   -- If the **AuthenticationMethod** parameter is set to PSK, then the interface for which the destination IP address matches the incoming IP address is activated. 

   -- If the **AuthenticationMethod** parameter is set to user name, then the interface for which the name matches the user name is activated. 

   -- If the **AuthenticationMethod** parameter is certificates, then the interface for which the name matches the certificate subject name is activated.
metadata:
  external help file: UnifiedRA_Cmdlets.xml
  Module Name: RemoteAccess
  online version: https://docs.microsoft.com/powershell/module/remoteaccess/set-vpns2sinterface?view=windowsserver2012-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
