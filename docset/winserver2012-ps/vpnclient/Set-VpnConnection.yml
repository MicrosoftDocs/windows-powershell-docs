### YamlMime:PowershellCmdlet
summary: |-
  Changes the configuration settings of an existing VPN connection profile.
module: VpnClient
notes: ""
outputs:
- name: <xref href="Microsoft.Management.Infrastructure.CimInstance#VpnConnection" data-throw-if-not-resolved="False" />
  description: |-
    The `Microsoft.Management.Infrastructure.CimInstance` object is a wrapper class that displays Windows Management Instrumentation (WMI) objects.
    The path after the pound sign (`#`) provides the namespace and class name for the underlying WMI object.

    The VpnConnection object contains the VpnConnection configuration settings.
links:
- text: Add-VpnConnection
  href: ./Add-VpnConnection.yml
- text: Get-VpnConnection
  href: ./Get-VpnConnection.yml
- text: Remove-VpnConnection
  href: ./Remove-VpnConnection.yml
syntaxes:
- >-
  Set-VpnConnection [[-RememberCredential] <Boolean>] [[-UseWinlogonCredential] <Boolean>]

   [[-EapConfigXmlStream] <XmlDocument>] [-Name] <String> [[-ServerAddress] <String>] [[-TunnelType] <String>]

   [[-EncryptionLevel] <String>] [[-AuthenticationMethod] <String[]>] [[-SplitTunneling] <Boolean>]

   [-AllUserConnection] [[-L2tpPsk] <String>] [-AsJob] [-CimSession <CimSession[]>] [-Force] [-PassThru]

   [-ThrottleLimit <Int32>] [-Confirm] [-WhatIf]
examples:
- title: 'Example 1: Configure a single VPN connection'
  code: |-
    PS C:\> Set-VpnConnection -Name "Test1" -ServerAddress "10.1.1.2" -PassThru
    Name                  : Test1

    ServerAddress         : 10.1.1.2

    AllUserConnection     : False

    Guid                  : {4B308E9B-C225-42CB-8158-307193429591}

    TunnelType            : Automatic

    AuthenticationMethod  : {MsChapv2}

    EncryptionLevel       : Required

    L2tpIPsecAuth         : Certificate

    UseWinlogonCredential : False

    EapConfigXmlStream    :   
    ConnectionStatus      : Disconnected

    NapState              : NotConnected

    RememberCredential    : False

    SplitTunneling        : False
  description: |-
    This command configures the VPN connection named Test1 to connect to the server with an IP address of 10.1.1.2.
    By specifying the **Passthru** parameter, you can see the configuration of the VPN connection object.
  summary: ""
- title: 'Example 2:'
  code: |-
    PS C:\>Set-VpnConnection -Name "Test3" -AllUserConnection -TunnelType L2tp -EncryptionLevel Optional -AuthenticationMethod Pap -SplitTunneling:$false -RememberCredential:$false -PassThru

    WARNING: The currently selected encryption level requires EAP or MS-CHAPv2 logon security methods. Data encryption will not occur for Pap or Chap.

    Name                  : Test3

    ServerAddress         : 10.1.1.1

    AllUserConnection     : True

    Guid                  : {76746D4E-D72A-467D-A11F-3D4D9075F50D}

    TunnelType            : L2tp

    AuthenticationMethod  : {Pap}

    EncryptionLevel       : Optional

    L2tpIPsecAuth         : Certificate

    UseWinlogonCredential : False

    EapConfigXmlStream    :

    ConnectionStatus      : Disconnected

    NapState              : NotConnected

    RememberCredential    : False

    SplitTunneling        : False
  description: |-
    This command configures the VPN connection named Test3 and located in the global phone book as follows: 

    - The connection is configured to use L2tp as the tunnel type, as specified by the **TunnelType** parameter 
    - The tunnel is using optional encryption, as specified by the **EncryptionLevel** parameter 
    - The authentication method used by the connection is PAP, as specified by the **AuthenticationMethod** parameter 
    - Split tunneling is turned off, as specified by the **SplitTunneling** parameter, and the value of `$false`
    - Credential caching is turned off, as specified by the **RememberCredential** parameter and the value of  `$false`

    By specifying the **Passthru** parameter, you can see the configuration of the VPN connection object.
  summary: ""
- title: 'Example 3: Configure a VPN connection to use a custom EAP configuration'
  code: |-
    This command stores the result of the New-EapConfiguration cmdlet into the variable named $a.
    PS C:\>$a = New-EapConfiguration -Tls


    This command configures the VPN connection named Test4 in the global phone book to use the custom EAP configuration by: 

    -- Specifying the **AuthenticationMethod** parameter with the value EAP
    -- Specifying the **EapConfigXmlStream** parameter with the value of the **EapConfigXmlStream** method of the previously created variable.By specifying the **Passthru** parameter, you can see the configuration of the VPN connection object.
    PS C:\>Set-VpnConnection -Name "Test4" -AllUserConnection -AuthenticationMethod Eap -EapConfigXmlStream $a.EapConfigXmlStream -PassThru

    Name                  : Test4

    ServerAddress         : 10.1.1.1

    AllUserConnection     : True

    Guid                  : {1D423FF3-E3D4-404A-B052-DB9130656D29}

    TunnelType            : L2tp

    AuthenticationMethod  : {Eap}

    EncryptionLevel       : Required

    L2tpIPsecAuth         : Psk

    UseWinlogonCredential : False

    EapConfigXmlStream    : #document

    ConnectionStatus      : Disconnected

    NapState              : NotConnected

    RememberCredential    : True

    SplitTunneling        : True
  description: |-
    This set of commands first creates a custom EAP configuration, and then configures a VPN connection from the global phone book to use the new custom EAP configuration.

    For more information about custom EAP creation, see the New-EapConfiguration cmdlet.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: AllUserConnection
  description: |+
    Indicates that the VPN connection specified is in the global phone book.

  defaultValue: None
  pipelineInput: true
  position: "8"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsJob
  description: |+
    ps_cimcommon_asjob

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: AuthenticationMethod
  description: |+
    Specifies the authentication method to use for the VPN connection.
    The acceptable values for this parameter are:**PAP**, **CHAP**, **MSCHAPv2**, or **EAP**.

  defaultValue: MSChapv2
  pipelineInput: true
  position: "6"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="CimSession" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: CimSession
  description: |+
    Runs the cmdlet in a remote session or on a remote computer.
    Enter a computer name or a session object, such as the output of a New-CimSessionhttp://go.microsoft.com/fwlink/p/?LinkId=227967 or Get-CimSessionhttp://go.microsoft.com/fwlink/p/?LinkId=227966 cmdlet.
    The default is the current session on the local computer.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: "False"
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="XmlDocument" data-throw-if-not-resolved="False" />
  name: EapConfigXmlStream
  description: |+
    Specifies the contents of the EAP XML configuration file, which includes the EAP method identifier (ID).

  defaultValue: None
  pipelineInput: true
  position: "12"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: EncryptionLevel
  description: |+
    Specifies the encryption level for the VPN connection.
    The acceptable values for this parameter are:**NoEncryption**, **Optional**, **Required** and **Maximum**.

  defaultValue: Required
  pipelineInput: true
  position: "5"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Force
  description: |+
    Indicates that the pre-shared key (PSK) value is be supplied over an insecure channel, if L2TP is used,

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: L2tpPsk
  description: |+
    Specifies the value of the PSK to be used for L2TP authentication.
    If this parameter is not specified, a certificate is used for L2TP.

  defaultValue: None
  pipelineInput: true
  position: "9"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Name
  isRequired: true
  description: |+
    Specifies the name of the VPN connection profile.

  defaultValue: None
  pipelineInput: true
  position: "2"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: PassThru
  description: |+
    Returns an object representing the item with which you are working.
    By default, this cmdlet does not generate any output.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: RememberCredential
  description: |+
    Indicates that the credentials supplied at the time of first successful connection is stored in the cache, if set to `$true`..

  defaultValue: None
  pipelineInput: true
  position: "10"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ServerAddress
  description: |+
    Specifies the address of the remote VPN server to which the client connects.
    You can specify the address as a URL, an IPv4 address, or an IPv6 address.

  defaultValue: None
  pipelineInput: true
  position: "3"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: SplitTunneling
  description: |+
    Indicates that split tunneling is enabled for the VPN connection profile, if set to `$true`

  defaultValue: None
  pipelineInput: true
  position: "7"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: ThrottleLimit
  description: |+
    Specifies the maximum number of concurrent operations that can be established to run the cmdlet.
    If this parameter is omitted or a value of `0` is entered, then Windows PowerShellÂ® calculates an optimum throttle limit for the cmdlet based on the number of CIM cmdlets that are running on the computer.
    The throttle limit applies only to the current cmdlet, not to the session or to the computer.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: TunnelType
  description: |+
    Specifies the type of tunnel used for the VPN connection.
    The acceptable values for this parameter are:**PPTP**, **L2TP**, **SSTP**, **IKEv2**, or **Automatic**.

  defaultValue: Automatic
  pipelineInput: true
  position: "4"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: UseWinlogonCredential
  description: |+
    Indicates that MSCHAPv2 or EAP-MSCHAPv2 is used as the authentication method, and that Windows logon credentials are used automatically when connecting with the VPN connection profile, if set to `$true`

  defaultValue: None
  pipelineInput: true
  position: "11"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs.
    The cmdlet is not run.

  defaultValue: "False"
  position: Named
  aliases: ""
  parameterValueGroup: ""
uid: VpnClient.Set-VpnConnection
name: Set-VpnConnection
description: |-
  The **Set-VpnConnection** cmdlet changes the configuration settings of an existing VPN connection profile. 
  If the VPN profile specified does not exist, you see an error. 
  If errors occur when you modify the VPN profile, the error information is returned.
metadata:
  external help file: VpnClient_Cmdlets.xml
  Module Name: VpnClient
  online version: https://docs.microsoft.com/powershell/module/vpnclient/set-vpnconnection?view=windowsserver2012-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
