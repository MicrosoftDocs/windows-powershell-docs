### YamlMime:PowershellCmdlet
summary: |-
  Sets configuration properties for the Cluster-Aware Updating (CAU) clustered role on the specified cluster.
module: ClusterAwareUpdating
notes: ""
inputs:
- name: <xref href="None" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="None" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Add-CauClusterRole
  href: ./Add-CauClusterRole.yml
- text: Disable-CauClusterRole
  href: ./Disable-CauClusterRole.yml
- text: Enable-CauClusterRole
  href: ./Enable-CauClusterRole.yml
- text: Get-CauClusterRole
  href: ./Get-CauClusterRole.yml
- text: Remove-CauClusterRole
  href: ./Remove-CauClusterRole.yml
syntaxes:
- >-
  Set-CauClusterRole [-UseDefault] [-StartDate <DateTime>] [-DaysOfWeek <Weekdays>] [-WeeksOfMonth <Int32[]>]

   [-CauPluginName <String[]>] [-CauPluginArguments <Hashtable[]>] [-MaxFailedNodes <Int32>]

   [-MaxRetriesPerNode <Int32>] [-NodeOrder <String[]>] [-PreUpdateScript <String>] [-PostUpdateScript <String>]

   [-ConfigurationName <String>] [-RequireAllNodesOnline] [-WarnAfter <TimeSpan>] [-StopAfter <TimeSpan>]

   [-RebootTimeoutMinutes <Int32>] [-SeparateReboots] [-RunPluginsSerially] [-StopOnPluginFailure]

   [-EnableFirewallRules] [-FailbackMode <FailbackType>] [[-ClusterName] <String>] [[-Credential] <PSCredential>]

   [-Force] [-WhatIf] [-Confirm] [<CommonParameters>]
- >-
  Set-CauClusterRole [-UpdateNow] [[-ClusterName] <String>] [[-Credential] <PSCredential>] [-Force] [-WhatIf]

   [-Confirm] [<CommonParameters>]
- >-
  Set-CauClusterRole [-UseDefault] [-StartDate <DateTime>] [-DaysOfWeek <Weekdays>] [-IntervalWeeks <Int32>]

   [-CauPluginName <String[]>] [-CauPluginArguments <Hashtable[]>] [-MaxFailedNodes <Int32>]

   [-MaxRetriesPerNode <Int32>] [-NodeOrder <String[]>] [-PreUpdateScript <String>] [-PostUpdateScript <String>]

   [-ConfigurationName <String>] [-RequireAllNodesOnline] [-WarnAfter <TimeSpan>] [-StopAfter <TimeSpan>]

   [-RebootTimeoutMinutes <Int32>] [-SeparateReboots] [-RunPluginsSerially] [-StopOnPluginFailure]

   [-EnableFirewallRules] [-FailbackMode <FailbackType>] [[-ClusterName] <String>] [[-Credential] <PSCredential>]

   [-Force] [-WhatIf] [-Confirm] [<CommonParameters>]
- >-
  Set-CauClusterRole [-UseDefault] [[-ClusterName] <String>] [[-Credential] <PSCredential>] [-Force] [-WhatIf]

   [-Confirm] [<CommonParameters>]
examples:
- title: EXAMPLE 1
  code: |-
    PS C:\> Set-CauClusterRole -ClusterName CONTOSO-FC1 -DaysOfWeek Tuesday -WeeksOfMonth 1,2 -RebootTimeoutMinutes 10 -Force
  description: |-
    This example configures settings for the CAU clustered role on the cluster named CONTOSO-FC1.
    The CAU clustered role is configured to perform Updating Runs on Tuesdays on the first and second weeks of each month.
    The CAU clustered role will allow 10 minutes for the restarting of each node, if a restart is necessary.
    If the restart does not complete within this time, then the Updating Run on that node will be marked as failed.
    The cmdlet runs without displaying confirmation prompts.
  summary: ""
- title: EXAMPLE 2
  code: |-
    PS C:\> Set-CauClusterRole -ClusterName CONTOSO-FC1 -DaysOfWeek Tuesday -WeeksInterval 2 -RebootTimeoutMinutes 10 -PostUpdateScript c:\verifyupdatesinstalled.ps1 -Force
    Name                                                        Value 
    ----                                                        ----- 
    ResourceGroupName                                           CAUCAUCldy8 
    Status                                                      Online 
    StartDate                                                   10/14/2011 3:00:00 AM 
    PostUpdateScript                                            G:\verifyupdatesinstalled.ps1 
    RebootTimeoutMinutes                                        10 
    DaysOfWeek                                                  Tuesday 
    WeeksInterval                                               2
  description: |-
    This example configures settings for the CAU clustered role on the cluster named CONTOSO-FC1.
    The CAU clustered role is configured to perform Updating Runs on Tuesdays on the second week of each month.
    The CAU clustered role will allow 10 minutes for the restarting of each node, if a restart is necessary.
    If the restart does not complete within this time, then the Updating Run on that node will be marked as failed.
    The CAU clustered role runs a script after updating completes, just after the node leaves Maintenance mode.
    The script is located at the root of drive G: in clustered storage and is called verifyupdatesinstalled.ps1.
    The cmdlet runs without displaying confirmation prompts.
  summary: ""
- title: EXAMPLE 3
  code: |-
    PS C:\> Set-CauClusterRole -ClusterName CONTOSO-FC1 -UpdateNow -Force
  description: |-
    This example causes the CAU clustered role to initiate an Updating Run immediately on the cluster named CONTOSO-FC1.
    The cmdlet runs without displaying confirmation prompts.
  summary: ""
- title: EXAMPLE 4
  code: |-
    PS C:\> $warnafter = New-TimeSpan -hour 1 -minute 90 -seconds 10
    PS C:\> $stopafter = New-TimeSpan -hour 2 -minute 90 -seconds 10
    PS C:\> Set-CauClusterRole -ClusterName CONTOSO-FC1 -WarnAfter $warnafter -StopAfter $stopafter -StartDate 1/1/2012 -Force
  description: |-
    This example configures settings for the CAU clustered role on the cluster named CONTOSO-FC1.
    Time spans are specified for logging a warning or canceling the Updating Run if it is not completed.
    The earliest date that an updating run can be triggered is 1/1/2012.
    The cmdlet runs without displaying confirmation prompts.
  summary: ""
parameters:
- type: <xref href="Hashtable" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: CauPluginArguments
  description: "Passes a set of name=value pairs (arguments) for each updating plug-in to use.\r\nFor example, to specify a Domain argument for one plug-in: \r\n                         \r\n - `@{Domain=Domain.local}`\r\n                         \r\nYou can specify multiple pairs in a set separated with semicolons.\r\nFor example: \r\n                         \r\n - `@{name1=value1;name2=value2;name3=value3}`\r\n                         \r\nThese name=value pairs must be meaningful to the **CauPluginName** that you specify. \r\n                         \r\nIf you specify arguments for more than one plug-in, provide the sets of name=value pairs in the order that you pass values in **CauPluginName**, separated by commas.\r\nFor example: \r\n                         \r\n - `@{name1=value1;name2=value2;name3=value3},@{name4=value4;name5=value5}`\r\n\r\n                         \r\nFor the default **Microsoft.WindowsUpdatePlugin** plug-in, no arguments are needed.\r\nThe following arguments are optional: \r\n                         \r\n - **'IncludeRecommendedUpdates'='\\<Value\\>'**: Boolean value to indicate that recommended updates will be applied in addition to important updates on each node.\r\nIf not specified, the default value is **'False'**. \r\n                         \r\n - A standard Windows Update Agent query string that specifies criteria used by the Windows Update Agent to filter the updates that will be applied to each node.\r\nFor a name, use **QueryString** and for a value, enclose the full query in quotation marks. \r\n                         \r\nIf not specified, then the **Microsoft.WindowsUpdatePlugin** plug-in by default uses the following argument: \r\n                         \r\n - `QueryString=\"IsInstalled=0 and Type='Software' and IsHidden=0 and IsAssigned=1\"`\r\n                         \r\nFor more information about query strings for the default **Microsoft.WindowsUpdatePlugin** plug-in and the criteria such as IsInstalled that can be included in the query strings, see the topic about search criteria in the Windows Update Agent (WUA) API Referencehttp://go.microsoft.com/fwlink/p/?LinkId=223304. \r\n\r\n                         \r\nFor the **Microsoft.HotfixPlugin** plug-in, the following argument is required: \r\n                         \r\n - **HotfixRootFolderPath=\\<Path\\>**: The UNC path to a hotfix root folder in an SMB share with a structure that contains the updates to apply and that contains the hotfix configuration file  \r\n\r\n                         \r\nThe following arguments are optional for the **Microsoft.HotfixPlugin** plug-in: \r\n                         \r\n - **RequireSmbEncryption=\\<Value\\>**: Boolean value to indicate that SMB Encryption will be enforced for accessing data from the SMB share.\r\nIf not specified, the default value is **'False'**.\r\nTo ensure the integrity of the data accessed from the SMB share, the plug-in requires that the share is enabled for either SMB signing or SMB Encryption. \r\n                         \r\n - **DisableAclChecks=\\<Value\\>**: Boolean value to indicate that the plug-in will check for sufficient permissions on the hotfix root folder and the hotfix configuration file.\r\nIf not specified, the default value is **'False'**. \r\n                         \r\n - **HotfixInstallerTimeoutMinutes=\\<Integer\\>**: The length of time in minutes that the plug-in allows the hotfix installer process to return.\r\nIf not specified, the default value is 30 minutes. \r\n                         \r\n                         \r\n - **HotfixConfigFileName=\\<name\\>**: Name for the hotfix configuration file.\r\nIf not specified, the default name DefaultHotfixConfig.xml is used. \r\nFor more information about required and optional arguments for the **Microsoft.HotfixPlugin** plug-in, see the content about Cluster-Aware Updating plug-inshttp://go.microsoft.com/fwlink/p/?LinkId=235333.\r\n\r\n"
  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: CauPluginName
  description: |+
    Specifies one or more plug-ins to use when performing scans or updates.
    You can specify multiple values separated with commas.
    The default is the Microsoft.WindowsUpdatePlugin plug-in.
    This plug-in coordinates the Windows Update Agent software resident on each cluster node, the same software that is used when updates are downloaded from Windows Update or Microsoft Update, or from a Windows Server Update Services (WSUS) server.
    For more information about how plug-ins work with CAU, see the content about Cluster-Aware Updating plug-inshttp://go.microsoft.com/fwlink/p/?LinkId=235333.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ClusterName
  description: |+
    Specifies the name of the cluster on which to configure the CAU clustered role.
    If not specified, then the current cluster is used.
    This parameter is only required when this cmdlet is not run on a failover cluster node, or this cmdlet is used to reference a failover cluster different from where the cmdlet is run.

  defaultValue: None
  position: "0"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ConfigurationName
  description: |+
    Specifies the Windows PowerShell session configuration that defines the session in which scripts (specified by **PreUpdateScript** and **PostUpdateScript**) and cmdlets are run, and can limit the cmdlets that are available to be run.
    If either a pre-update or post-update script is specified but a configuration name is not specified, then the default session configuration that is built into Windows PowerShell ("Microsoft.PowerShell") is used.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: "False"
  position: Named
  aliases: cf
  parameterValueGroup: ""
- type: <xref href="PSCredential" data-throw-if-not-resolved="False" />
  name: Credential
  description: |+
    Specifies the administrative credentials for the target cluster.

  defaultValue: None
  position: "1"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Weekdays" data-throw-if-not-resolved="False" />
  name: DaysOfWeek
  description: "Specifies the days of the week on which the task will be triggered.\r\nMultiple values can be specified either separated with commas or as a hexadecimal sum. \r\n                         \r\n - **Sunday:** (0x01) \r\n                         \r\n - **Monday:** (0x02) \r\n                         \r\n - **Tuesday:** (0x04) \r\n                         \r\n - **Wednesday:** (0x08) \r\n                         \r\n - **Thursday:** (0x10) \r\n                         \r\n - **Friday:** (0x20) \r\n                         \r\n - **Saturday:** (0x40) \r\n**Examples:**\r\n                         \r\n - **-DaysOfWeek:** Monday, Wednesday, Friday\r\n                         \r\n - **-DaysOfWeek:** 0x02, 0x08, 0x20\r\n                         \r\n - **-DaysOfWeek:** 0x2A\r\n\r\n"
  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: None, Sunday, Monday, Tuesday, Wednesday, Thursday, Friday, Saturday
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: EnableFirewallRules
  description: |+
    Enables the **Remote Shutdown** Windows Firewall rule group on each cluster node, if it is not already enabled, each time the CAU clustered role performs an Updating Run.
    Enabling this rule group permits inbound communication to each cluster node during each Updating Run that allows CAU to shut down and restart the node remotely (if the installation of an update requires a restart).
    If Windows Firewall is in use on the cluster nodes and the rule group is not enabled, the Updating Run will fail.
    The **Remote Shutdown** Windows Firewall rule group is not enabled when it will conflict with Group Policy settings that are configured for Windows Firewall.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="FailbackType" data-throw-if-not-resolved="False" />
  name: FailbackMode
  description: |+
    Specifies the method used to bring drained workloads back to the node, at the end of updating the node.
    Drained workloads are workloads that were previously running on the node, but were moved to another node.
    The acceptable values for this parameter are:NoFailback, Immediate, and Policy.
    The default value is Immediate.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: NoFailback, Immediate, Policy
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Force
  description: |+
    Runs the cmdlet without prompting for confirmation.
    By default the cmdlet will ask for confirmation from the user before proceeding.

  defaultValue: None
  position: Named
  aliases: f
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: IntervalWeeks
  description: |+
    Specifies the interval between weeks when the task will be triggered.
    An interval of `1` produces a weekly schedule.
    An interval of `2` produces an every-other week schedule.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: MaxFailedNodes
  description: |+
    Specifies the maximum number of nodes on which updating can fail.
    If one more than this number of nodes fails, then the Updating Run is stopped.
    The range is from zero (`0`) through 1 less than the number of cluster nodes.
    The default for most clusters is approximately one-third of the number of nodes.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: MaxRetriesPerNode
  description: |+
    Specifies the maximum number of times that the update process (including any pre-update and post-update scripts) will be retried per node.
    The maximum is `64` and the default is `3`.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: NodeOrder
  description: |+
    Specifies the names of the cluster nodes in the order that they should be updated.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: PostUpdateScript
  description: |+
    Specifies the path and file name for a Windows PowerShell script to run after updating completes, just after the node leaves **Maintenance** mode.
    The file name extension must be `.ps1` and the total length of the path plus the file name must be no longer than 260 characters.
    As a best practice, the script should be located on a disk in cluster storage, to ensure that it is always accessible to all of the cluster nodes.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: PreUpdateScript
  description: |+
    Specifies the path and file name for a Windows PowerShell script to run on each node before updating begins, and before the node is put into **Maintenance** mode.
    The file name extension must be `.ps1` and the total length of the path plus the file name must be no longer than 260 characters.
    As a best practice, the script should be located on a disk in cluster storage, to ensure that it is always accessible to all of the cluster nodes.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: RebootTimeoutMinutes
  description: |+
    Specifies the time in minutes that CAU will allow for the restarting of a node (if a restart is necessary).
    If the restart does not complete within this time, then the Updating Run on that node will be marked as failed.

  defaultValue: "15"
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: RequireAllNodesOnline
  description: |+
    Specifies that all cluster nodes must be online and reachable before updating begins.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: RunPluginsSerially
  description: |+
    When multiple plug-ins are used during an Updating Run, specifies that CAU will scan each cluster node for applicable updates and stage the updates for each plug-in in the plug-in order passed in **CauPluginName**.
    By default, CAU scans and stages the applicable updates for all plug-ins in parallel.
    Regardless of the configuration of this parameter, CAU installs the applicable updates for each plug-in sequentially.
    **Note:** The parameter is valid only when multiple plug-ins are specified in **CauPluginName**.
    If a single plug-in is specified, a warning appears.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: SeparateReboots
  description: |+
    When multiple plug-ins are used during an Updating Run, specifies that CAU will shut down and restart a cluster node after each plug-in installs updates on the node, if the installation of an update by a plug-in requires a restart.
    By default, during an Updating Run, all plug-ins complete the installation of updates on a cluster node before the node restarts one time (if a restart is necessary).
    **Note:** The parameter is valid only when multiple plug-ins are specified in **CauPluginName**.
    If a single plug-in is specified, a warning appears.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="DateTime" data-throw-if-not-resolved="False" />
  name: StartDate
  description: |+
    Specifies the earliest date on which the Updating Run can be triggered.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="TimeSpan" data-throw-if-not-resolved="False" />
  name: StopAfter
  description: |+
    Specifies the time in minutes after which the Updating Run will be canceled if it has not completed.
    The time span can be expressed in the standard ways available in Windows PowerShell, for example, `01:30:00` represents one hour and thirty minutes.
    By default, the Updating Run is allowed an unlimited amount of time to complete. 
    **Note:** If pre-update or post-update scripts are specified, then the entire process of running scripts and performing updates must be complete within this time limit.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: StopOnPluginFailure
  description: |+
    When multiple plug-ins are used during an Updating Run, specifies that if a failure occurs during the application of updates on a node by any plug-in, subsequent updates on the node that are coordinated by the remaining plug-ins are stopped.
    By default, a failure by one plug-in does not affect the application of updates on a node by other plug-ins. 
    **Note:** The parameter is valid only when multiple plug-ins are specified in **CauPluginName**.
    If a single plug-in is specified, a warning appears.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: UpdateNow
  description: |+
    Instructs the CAU clustered role to immediately initiate an Updating Run using the configured settings.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: UseDefault
  description: |+
    Specifies that default values will be used for all parameters that do not have specified values.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="TimeSpan" data-throw-if-not-resolved="False" />
  name: WarnAfter
  description: |+
    Specifies the time in minutes after which a warning will be logged if the Updating Run (including any pre-update and post-update scripts) has not completed.
    By default, no warning will be logged, regardless of the time taken by the Updating Run.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: WeeksOfMonth
  description: |+
    Specifies the weeks of the month when the Updating Run should be run.
    The value `5` represents the last week of the month.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs.
    The cmdlet is not run.

  defaultValue: "False"
  position: Named
  aliases: wi
  parameterValueGroup: ""
uid: ClusterAwareUpdating.Set-CauClusterRole
name: Set-CauClusterRole
description: |-
  The **Set-CauClusterRole** cmdlet sets configuration properties for the Cluster-Aware Updating (CAU) clustered role on the specified cluster.
  This cmdlet can specify properties such as the updating schedule and Updating Run parameters.

  Note: To run this cmdlet with the **PostUpdateScript** or **PreUpdateScript** parameter, Windows PowerShell® remoting must be enabled on each node.
  To do this, run the Enable-PSRemotinghttp://go.microsoft.com/fwlink/p/?LinkId=144300 cmdlet.
  In addition, ensure that the Windows Remote Management - Compatibility Mode (HTTP-In) firewall exception is enabled on each node.
metadata:
  external help file: ClusterAwareUpdating.dll-Help.xml
  Module Name: ClusterAwareUpdating
  ms.date: 10/30/2017
  online version: https://docs.microsoft.com/powershell/module/clusterawareupdating/set-cauclusterrole?view=windowsserver2012r2-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  title: Set-CauClusterRole
