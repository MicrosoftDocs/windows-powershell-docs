### YamlMime:PowershellCmdlet
summary: |-
  Creates a PEF action that runs a script block.
module: PEF
notes: ""
links:
- text: New-PefDateTimeTrigger
  href: ./New-PefDateTimeTrigger.yml
- text: New-PefKeyDownTrigger
  href: ./New-PefKeyDownTrigger.yml
- text: New-PefMessageTrigger
  href: ./New-PefMessageTrigger.yml
- text: New-PefProcessTrigger
  href: ./New-PefProcessTrigger.yml
- text: New-PefTimeSpanTrigger
  href: ./New-PefTimeSpanTrigger.yml
syntaxes:
- Invoke-PefCustomAction [-Script] <ScriptBlock> [-Trigger <Trigger[]>] [<CommonParameters>]
examples:
- title: 'Example 1: Create an ICMP trigger action'
  code: |-
    PS C:\> $T = New-PefKeyDownTrigger -CtrlC
    PS C:\> $Sb = { $Host.UI.WriteErrorLine("ICMP found") }
    PS C:\> $S = New-PefTraceSession -Mode Linear -SaveOnStop -Path "C:\Traces\Simple" -Force -SaveAsParsed
    PS C:\> Add-PefMessageSource -PEFSession $S -Source Microsoft-Pef-WFP-MessageProvider
    PS C:\> $T2 = New-PefMessageTrigger  -PEFSession $S -Filter "ICMP" -Repeat
    PS C:\> Invoke-PefCustomAction -Script $Sb -Trigger $T2
    PS C:\> Stop-PefTraceSession -PEFSession $S -Trigger $T
    PS C:\> Start-PefTraceSession -PEFSession $S
  description: |-
    This command creates a script block, stored in the variable $Sb, that **Invoke-PefCustomAction** runs when the trigger criteria matches.
    The New-PefMessageTrigger cmdlet defines the trigger by specifying a filter for ICMP.
    When the trigger matches, the script block runs, which displays the message ICMP found.
  summary: ""
parameters:
- type: <xref href="ScriptBlock" data-throw-if-not-resolved="False" />
  name: Script
  isRequired: true
  description: |+
    Specifies a script block to invoke.
    For more information about script blocks, type `Get-Help about_script_blocks`.

  defaultValue: None
  position: "0"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Trigger" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: Trigger
  description: |+
    Specifies an array of **Trigger** objects.
    When one of these triggers runs, the action runs the script block specified by the **Script** parameter.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
uid: PEF.Invoke-PefCustomAction
name: Invoke-PefCustomAction
description: |-
  The **Invoke-PefCustomAction** cmdlet creates a Protocol Engineering Framework (PEF) action that runs a Microsoft PowerShell script block.
  Specify a script block to run and a trigger for the action.
metadata:
  external help file: Microsoft.Protocols.Tools.PowerShell.dll-Help.xml
  Module Name: PEF
  ms.date: 10/30/2017
  online version: https://docs.microsoft.com/powershell/module/pef/invoke-pefcustomaction?view=windowsserver2012r2-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  title: Invoke-PefCustomAction
