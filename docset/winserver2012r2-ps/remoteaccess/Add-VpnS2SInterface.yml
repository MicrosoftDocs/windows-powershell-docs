### YamlMime:PowershellCmdlet
summary: |-
  Creates a site-to-site (S2S) interface with the specified parameters.
module: RemoteAccess
notes: ""
inputs:
- name: <xref href="None" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="Microsoft.Management.Infrastructure.CimInstance#VpnS2SInterface" data-throw-if-not-resolved="False" />
  description: |-
    The `Microsoft.Management.Infrastructure.CimInstance` object is a wrapper class that displays Windows Management Instrumentation (WMI) objects.
    The path after the pound sign (`#`) provides the namespace and class name for the underlying WMI object.
links:
- text: Add-VpnS2SInterface
  href: ./Add-VpnS2SInterface.yml
- text: Clear-VpnS2SInterfaceStatistics
  href: ./Clear-VpnS2SInterfaceStatistics.yml
- text: Connect-VpnS2SInterface
  href: ./Connect-VpnS2SInterface.yml
- text: Disconnect-VpnS2SInterface
  href: ./Disconnect-VpnS2SInterface.yml
- text: Get-VpnAuthProtocol
  href: ./Get-VpnAuthProtocol.yml
- text: Get-VpnS2SInterface
  href: ./Get-VpnS2SInterface.yml
- text: Get-VpnS2SInterfaceStatistics
  href: ./Get-VpnS2SInterfaceStatistics.yml
- text: Remove-VpnS2SInterface
  href: ./Remove-VpnS2SInterface.yml
- text: Set-VpnAuthProtocol
  href: ./Set-VpnAuthProtocol.yml
- text: Set-VpnS2SInterface
  href: ./Set-VpnS2SInterface.yml
syntaxes:
- >-
  Add-VpnS2SInterface [-Name] <String> [-Protocol <String>] [-Destination] <String[]> [-AdminStatus <Boolean>]

   [-PromoteAlternate <Boolean>] [-AuthenticationMethod <String>] [-PostConnectionIPv4Subnet <String[]>]

   [-PostConnectionIPv6Subnet <String[]>] [-InitiateConfigPayload <Boolean>] [-RadiusAttributeClass <String>]

   [-EnableQoS <EnableQoS>] [-TxBandwidthKbps <UInt64>] [-RxBandwidthKbps <UInt64>]

   [-IPv4TriggerFilter <String[]>] [-IPv6TriggerFilter <String[]>] [-Persistent]

   [-IPv4TriggerFilterAction <Action>] [-IPv6TriggerFilterAction <Action>]

   [-SADataSizeForRenegotiationKilobytes <UInt32>] [-IPv4Subnet <String[]>] [-IPv6Subnet <String[]>]

   [-ResponderAuthenticationMethod <String>] [-PassThru] [[-RoutingDomain] <String>]

   [-Certificate <X509Certificate2>] [-SharedSecret <String>] [-NetworkOutageTimeSeconds <UInt32>]

   [-NumberOfTries <UInt32>] [-RetryIntervalSeconds <UInt32>] [-SALifeTimeSeconds <UInt32>] [-EapMethod <String>]

   [-InternalIPv4 <Boolean>] [-InternalIPv6 <Boolean>] [-IdleDisconnectSeconds <UInt32>] [-UserName <String>]

   [-Password <String>] [-SourceIpAddress <String>] [-EncryptionType <String>] [-CimSession <CimSession[]>]

   [-ThrottleLimit <Int32>] [-AsJob] [-WhatIf] [-Confirm] [<CommonParameters>]
- >-
  Add-VpnS2SInterface [-Name] <String> [-Protocol <String>] [-Destination] <String[]> [-AdminStatus <Boolean>]

   [-PromoteAlternate <Boolean>] [-AuthenticationMethod <String>] [-PostConnectionIPv4Subnet <String[]>]

   [-PostConnectionIPv6Subnet <String[]>] [-InitiateConfigPayload <Boolean>] [-RadiusAttributeClass <String>]

   [-EnableQoS <EnableQoS>] [-TxBandwidthKbps <UInt64>] [-RxBandwidthKbps <UInt64>]

   [-IPv4TriggerFilter <String[]>] [-IPv6TriggerFilter <String[]>] [-Persistent]

   [-IPv4TriggerFilterAction <Action>] [-IPv6TriggerFilterAction <Action>]

   [-SADataSizeForRenegotiationKilobytes <UInt32>] [-IPv4Subnet <String[]>] [-IPv6Subnet <String[]>]

   [-ResponderAuthenticationMethod <String>] [-PassThru] [[-RoutingDomain] <String>]

   [-Certificate <X509Certificate2>] [-SharedSecret <String>] [-NetworkOutageTimeSeconds <UInt32>]

   [-NumberOfTries <UInt32>] [-RetryIntervalSeconds <UInt32>] [-SALifeTimeSeconds <UInt32>] [-EapMethod <String>]

   [-InternalIPv4 <Boolean>] [-InternalIPv6 <Boolean>] [-IdleDisconnectSeconds <UInt32>] [-UserName <String>]

   [-Password <String>] [-CustomPolicy] [-EncryptionMethod <EncryptionMethod>]

   [-IntegrityCheckMethod <IntegrityCheckMethod>] [-CipherTransformConstants <CipherTransformConstants>]

   [-AuthenticationTransformConstants <AuthenticationTransformConstants>] [-PfsGroup <PfsGroup>]

   [-DHGroup <DHGroup>] [-SourceIpAddress <String>] [-CimSession <CimSession[]>] [-ThrottleLimit <Int32>]

   [-AsJob] [-WhatIf] [-Confirm] [<CommonParameters>]
examples:
- title: EXAMPLE 1
  code: |-
    PS C:\> Add-VpnS2SInterface -Nameedge1 -Destination 131.107.0.20 -Protocol IKEv2 -AuthenticationMethod PSKOnly -SharedSecret abc -IPv4Subnet 10.2.0.0/24:100 -IPv6Subnet 2001:db8:2::/48:100
  description: |-
    This example creates a S2S VPN interface named edge1 to the destination server 131.107.0.20.
    The protocol is IKEv2 and the authentication method is PSK.
    The string abc is used as PSK.
    Traffic to 10.2.0.0/24 and 2001:db8:2::/48 is sent over this interface if there is no other interface on the server that has same routes with a metric less than 100 .
    In case the interface is in disconnected state the connection is triggered if there is no other interface on the server that has same routes with a metric less than 100.
  summary: ""
- title: EXAMPLE 2
  code: |-
    PS C:\>Add-VpnS2SInterface -IPv4Subnet @("131.0.1.0/24:254", "121.0.0.0/16:124") -UserName "abc@contoso.com" -Destination "30.0.0.1" -IPv6Subnet @("3ffe::/32:24", "2ffe::/32:24") -AuthenticationMethod "EAP" -Name "TestVpnS2SInterface" -RetryInterval 120 -EncryptionType "RequireEncryption" -InternalIPv4 1 -InternalIPv6 1 -NumberofTries 20 -AdminStatus $true -IdleDisconnectSeconds 300 -PromoteAlternate $true -Password "1111_aaaa" -PassThru
    Name                 Destination          AdminStatus  ConnectionState IPv4Subnet 
    ----                 -----------          -----------  --------------- ---------- 
    TestVpnS2SInterface  {30.0.0.1}           True         Disconnected    {131.0.1.0/24:254, 121.0.0.0/16:124}
  description: |-
    This example creates an interface that uses EAP authentication method and multiple subnets are routed on this interface including 131.0.1.0/24 and 121.0.0.0/16.
  summary: ""
- title: EXAMPLE 3
  code: |-
    PS C:\>Add-VpnS2SInterface -CustomPolicy -UserName "abc@contoso.com" -EncryptionMethod "AES128" -Destination "30.0.0.1" -Password "1111_aaaa" -DhGroup "Group2" -PfsGroup "PFS2" -CipherTransformConstants "AES128" -Name "TestVpnS2SInterface" -IntegrityCheckMethod "SHA256" -AuthenticationTransformConstants "SHA256128" -Protocol "IKEv2"
  description: |-
    This example creates a S2S VPN interface using custom encryption settings.
  summary: ""
- title: EXAMPLE 4
  code: |-
    PS C:\>$cert1 = Get-ChildItem -Path cert:LocalMachine\My | Where-Object -FilterScript { $_.Subject -Like "*CN=edge1.contoso.com*" }



    PS C:\>Add-VpnS2SInterface -Name e1 -Destination 1.1.1.1 -AuthenticationMethod MachineCertificates -Certificate $cert1 -ResponderAuthenticationMethod MachineCertificates -Protocol IKEv2
  description: |-
    This example creates a S2S interface with authentication method of computer certificate and specifies the certificate for which the subject name is edge1.contoso.com.
  summary: ""
parameters:
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: AdminStatus
  description: |+
    Specifies the administrator status of the cmdlet.

  defaultValue: "True"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsJob
  description: |+
    ps_cimcommon_asjob

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: AuthenticationMethod
  description: "Specifies the authentication method to be used by the S2S connection. \r\n \r\n                        \r\nIf PSK is specified, then there can only be one active S2S VPN interface per destination IP address.\r\n\r\n"
  defaultValue: EAP
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: 'EAP, MachineCertificates, PSKOnly, '
- type: <xref href="AuthenticationTransformConstants" data-throw-if-not-resolved="False" />
  name: AuthenticationTransformConstants
  description: |+
    Specifies a transform constant.
    The acceptable values for this parameter are:

    - SHA256128
    - MD596
    - SHA196
    - GCMAES128
    - GCMAES192
    - GCMAES256

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: FirstTransformType, AuthenticationTransformConstant
  parameterValueGroup: MD596, SHA196, SHA256128, GCMAES128, GCMAES192, GCMAES256, None
- type: <xref href="X509Certificate2" data-throw-if-not-resolved="False" />
  name: Certificate
  description: |+
    Specifies the certificate to be used in default store.
    Applicable only if **AuthenticationMethod** parameter is set to MachineCert.

  defaultValue: None
  position: Named
  aliases: Cert
  parameterValueGroup: ""
- type: <xref href="CimSession" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: CimSession
  description: |+
    Runs the cmdlet in a remote session or on a remote computer.
    Enter a computer name or a session object, such as the output of a New-CimSessionhttp://go.microsoft.com/fwlink/p/?LinkId=227967 or Get-CimSessionhttp://go.microsoft.com/fwlink/p/?LinkId=227966 cmdlet.
    The default is the current session on the local computer.

  defaultValue: None
  position: Named
  aliases: Session
  parameterValueGroup: ""
- type: <xref href="CipherTransformConstants" data-throw-if-not-resolved="False" />
  name: CipherTransformConstants
  description: |+
    Specifies a cipher transform constant.
    The acceptable values for this parameter are:

    - DES
    - DES3
    - AES128
    - AES192
    - AES256
    - GCMAES128
    - GCMAES192
    - GCMAES256

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: OtherCipherAlgorithm, FirstCipherAlgorithm, CipherTransformConstant
  parameterValueGroup: DES, DES3, AES128, AES192, AES256, GCMAES128, GCMAES192, GCMAES256, None
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: "False"
  position: Named
  aliases: cf
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: CustomPolicy
  isRequired: true
  description: |+
    Specifies the custom IKE IPsec policies.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: Destination
  isRequired: true
  description: |+
    Specifies the destination end point of the S2S connection. 
    Note: If the **Certificate** parameter is specified as PSK, then an IP address should be specified for this parameter as a fully qualified domain name (FQDN) will not work.

  defaultValue: None
  pipelineInput: true
  position: "2"
  aliases: RemoteTunnelEndpoint, RemoteTunnelHostname, RemoteAddress
  parameterValueGroup: ""
- type: <xref href="DHGroup" data-throw-if-not-resolved="False" />
  name: DHGroup
  description: |+
    Specifies the Diffie-Hellman (DH) group for the IPsec policy.

  defaultValue: "2"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: None, Group1, Group2, Group14, ECP256, ECP384, Group24
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: EapMethod
  description: |+
    Specifies the EAP method if IkeLocalAuthenticationMethod is EAP.

  defaultValue: MSCHAPv2
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: 'EAP-TLS, EAP-PEAP, EAP-MSCHAPv2, '
- type: <xref href="EnableQoS" data-throw-if-not-resolved="False" />
  name: EnableQoS
  description: |+
    Indicates whether to enable Quality of Service (QoS) on an interface.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: Disabled, Enabled
- type: <xref href="EncryptionMethod" data-throw-if-not-resolved="False" />
  name: EncryptionMethod
  description: |+
    Specifies the encryption method for the IKE policy.

  defaultValue: "4"
  pipelineInput: true
  position: Named
  aliases: Encryption
  parameterValueGroup: DES, DES3, AES128, AES192, AES256
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: EncryptionType
  description: |+
    Specifies the type of encryption.

  defaultValue: RequireEncryption
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: NoEncryption, RequireEncryption, OptionalEncryption, MaximumEncryption
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: IdleDisconnectSeconds
  description: |+
    Specifies the time interval, in seconds, after which an idle connection is disconnected.
    Unless you disable idle timeout, an idle connection is disconnected after this time interval is reached.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: IdleDurationSeconds, IdleDisconnectSec
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: InitiateConfigPayload
  description: |+
    Indicates whether to initiate Config payload negotiation.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="IntegrityCheckMethod" data-throw-if-not-resolved="False" />
  name: IntegrityCheckMethod
  description: |+
    Specifies the integrity method for the IPsec policy.

  defaultValue: "2"
  pipelineInput: true
  position: Named
  aliases: OtherHashAlgorithm, FirstIntegrityAlgorithm
  parameterValueGroup: MD5, SHA1, SHA256, SHA384
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: InternalIPv4
  description: |+
    Specifies that the IPv4 address should be negotiated.

  defaultValue: "True"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: InternalIPv6
  description: |+
    Specifies that the IPv6 address should be negotiated.

  defaultValue: "True"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: IPv4Subnet
  description: |+
    Specifies the IPv4 subnet that is routed on this connection with metrics.
    You must specify the IPv4 subnet in the format of *IPv4Address/SubnetPrefixLength:RouteMetric*.
    For example: 192.168.1.0/24:1

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: IPv4TriggerSubnet
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: IPv4TriggerFilter
  description: |+
    Specifies an array of IPv4 filters that trigger demand dial connections.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Action" data-throw-if-not-resolved="False" />
  name: IPv4TriggerFilterAction
  description: |+
    Indicates whether a filter should trigger an S2S connection.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: Allow, Deny
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: IPv6Subnet
  description: |+
    Specifies the IPv6 subnet that is routed on this connection with metrics.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: IPv6TriggerSubnet
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: IPv6TriggerFilter
  description: |+
    Specifies an array of IPv6 filters that trigger demand dial connections.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Action" data-throw-if-not-resolved="False" />
  name: IPv6TriggerFilterAction
  description: |+
    Indicates whether a filter should trigger an S2S connection.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: Allow, Deny
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Name
  isRequired: true
  description: |+
    Specifies the name of the connection.

  defaultValue: None
  pipelineInput: true
  position: "1"
  aliases: ElementName
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: NetworkOutageTimeSeconds
  description: |+
    Specifies the maximum amount of time, in seconds, before a connection is disconnected due to a network outage.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: NetworkOutageTimeSec
  parameterValueGroup: 3, 6, 9, 12, 15, 30, 60, 120, 240, 360, 720, 900
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: NumberOfTries
  description: "Specifies the number of connection attempts. \r\n \r\n                        \r\nIf this parameter is specified as zero (0), then the connection is not retried if the first attempt fails.\r\n\r\n"
  defaultValue: "3"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: PassThru
  description: |+
    Returns an object representing the item with which you are working.
    By default, this cmdlet does not generate any output.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Password
  description: |+
    Specifies the password for the user name to be used for dialing the connection.
    Applicable only if **AuthenticationMethod** parameter is set to EAP.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Persistent
  description: |+
    Indicates that a connection is not disconnected due to inactivity.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="PfsGroup" data-throw-if-not-resolved="False" />
  name: PfsGroup
  description: |+
    Specifies the PFS group in the IPsec policy.

  defaultValue: "3"
  pipelineInput: true
  position: Named
  aliases: PfsGroupId
  parameterValueGroup: None, PFS1, PFS2, PFS2048, ECP256, ECP384, PFSMM, PFS24
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: PostConnectionIPv4Subnet
  description: |+
    Specifies the IPv4 subnet routes that are added to a site-to-site interface after the connection is established.
    The values specified are not used to initiate the site-to-site VPN connection.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: PostConnectionIPv6Subnet
  description: |+
    Specifies the IPv6 subnet routes that are added to a site-to-site interface after the connection is established.
    The values specified are not used to initiate the site-to-site VPN connection.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: PromoteAlternate
  description: |+
    Specifies an IP address that if successfully connected becomes the primary IP address, and the current primary IP address is moved to the alternate list.

  defaultValue: "False"
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Protocol
  description: |+
    Specifies the underlying protocol used for tunneling.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: KeyModule
  parameterValueGroup: L2TP, IKEv2, Automatic
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: RadiusAttributeClass
  description: |+
    Specifies a RADIUS attribute.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ResponderAuthenticationMethod
  description: |+
    Specifies the authentication method to be used by the S2S initiator to validate the S2S responder.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: 'MachineCertificates, PSKOnly, '
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: RetryIntervalSeconds
  description: |+
    Specifies the time interval, in seconds, to wait between retries.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: RetryIntervalSec
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: RoutingDomain
  description: |+
    Specifies an ID, as a string, for a routing domain.
    The ID of a routing domain is a user-defined alphanumeric string.

  defaultValue: None
  pipelineInput: true
  position: "3"
  aliases: RoutingDomainName
  parameterValueGroup: ""
- type: <xref href="UInt64" data-throw-if-not-resolved="False" />
  name: RxBandwidthKbps
  description: |+
    Specifies the receive bandwidth limit, in kilobits per second (Kbps).

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: SADataSizeForRenegotiationKilobytes
  description: |+
    Specifies the amount of data, in kilobytes (KB), that can be transferred using a security association (SA).
    When the limit is reached, the SA must be renegotiated.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: SaRenegotiationDataSizeKB, LifeTimeKiloBytes
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: SALifeTimeSeconds
  description: |+
    Specifies the lifetime, in seconds, of a security association (SA).
    The SA is no longer valid after this time interval.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: SaLifeTimeSec, LifeTimeSeconds
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: SharedSecret
  description: |+
    Specifies the text of the shared secret to be used in the connection.
    This parameter is only applicable only if the **AuthenticationMethod** parameter is set to PSK or the **ResponderAuthenticationMethod** parameter is set to PSK.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: SourceIpAddress
  description: |+
    Specifies the source IPv4 or IPv6 addresses to use when dialing the connection.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: ThrottleLimit
  description: |+
    Specifies the maximum number of concurrent operations that can be established to run the cmdlet.
    If this parameter is omitted or a value of `0` is entered, then Windows PowerShell® calculates an optimum throttle limit for the cmdlet based on the number of CIM cmdlets that are running on the computer.
    The throttle limit applies only to the current cmdlet, not to the session or to the computer.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt64" data-throw-if-not-resolved="False" />
  name: TxBandwidthKbps
  description: |+
    Specifies a transmit bandwidth limit, in Kbps, for the interface.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: UserName
  description: |+
    Specifies the user name to be used for the connection.
    Applicable only if **AuthenticationMethod** parameter is set to EAP.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: User
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs.
    The cmdlet is not run.

  defaultValue: "False"
  position: Named
  aliases: wi
  parameterValueGroup: ""
uid: RemoteAccess.Add-VpnS2SInterface
name: Add-VpnS2SInterface
description: "The **Add-VpnS2SInterface** cmdlet creates a site-to-site (S2S) interface with the specified parameters.\r\nUse the **CustomPolicy** parameter to customize IPsec settings.\r\nIf the **Protocol** parameter is set to Automatic, then the only authentication method allowed is user name.\r\nIf the **AuthenticationMethod** parameter is set to pre-shared key (PSK), then only one interface can be enabled per destination and the initiator and responder policies are governed by what is specified per interface.\r\nIf the **AuthenticationMethod** parameter is set to user name or computer certificates (MachineCert), then only initiator policies are governed by what is specified per interface and responder policies are governed by what is specified on the server.\r\n\r\nFor incoming connections: \r\n \r\n                      \r\n -- If the **AuthenticationMethod** parameter is set to PSK, the interface for which the destination IP matches the incoming IP is activated. \r\n \r\n                      \r\n -- If the **AuthenticationMethod** parameter is set to user name, then the name of the interface that matches the user name is activated. \r\n \r\n                      \r\n -- If the **AuthenticationMethod** parameter is set to certificates, then the name of the interface that matches the certificate subject name is activated."
metadata:
  external help file: PS_VpnS2SInterface_v1.0.0.cdxml-help.xml
  Module Name: RemoteAccess
  ms.date: 12/05/2017
  online version: https://docs.microsoft.com/powershell/module/remoteaccess/add-vpns2sinterface?view=windowsserver2012r2-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  title: Add-VpnS2SInterface
