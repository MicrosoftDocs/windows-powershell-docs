### YamlMime:PowershellCmdlet
summary: |-
  Sets the Windows Hardware Error Architecture (WHEA) memory policy on a local or remote computer.
module: WHEA
notes: ""
syntaxes:
- >-
  Set-WheaMemoryPolicy [-ComputerName <String>] [-DisableOffline <Boolean>] [-DisablePFA <Boolean>]

   [-PersistMemoryOffline <Boolean>] [-PFAPageCount <UInt32>] [-PFAErrorThreshold <UInt32>]

   [-PFATimeout <UInt32>] [<CommonParameters>]
examples:
- title: 'Example 1: Enable WHEA predictive failure analysis'
  code: |-
    PS C:\>Set-WheaMemoryPolicy -DisablePFA $FALSE
  description: |-
    Enable PFA on the local computer.
  summary: ""
- title: 'Example 2: Change the memory time out policy on a remote computer'
  code: |-
    PS C:\>Set-WHEAMemoryPolicy -ComputerName TestPC -PFATimeout 600
  description: |-
    Change the WHEA memory policy on the remote computer TestPC to use a timeout of 600 seconds.
  summary: ""
- title: 'Example 3: Get and set WHEA memory policy in a script'
  code: |-
    PS C:\>$x=Get-WheaMemoryPolicy
    PS C:\>$x.DisableOffline=$TRUE$
    PS C:\>$x | Set-WheaMemoryPolicy
  description: |-
    Get the memory policy in the object x, change the value of x.DisableOffline to TRUE, and then use x to set the memory policy.
  summary: ""
parameters:
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ComputerName
  description: |+
    Name of the computer on which to set the policy.
    If you do not specify this value, the cmdlet sets policy on the local computer.
    You can use cn as an alias for ComputerName.

  defaultValue: None
  position: Named
  aliases: CN
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: DisableOffline
  description: |+
    Setting the DisableOffline policy element to TRUE prevents WHEA from removing memory pages in response to either corrected or uncorrected memory errors.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: DisablePFA
  description: |+
    Setting the DisablePFA policy element to TRUE stops WHEA from monitoring the memory pages that have corrected errors, and disables the predicative failure analysis algorithm.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: PersistMemoryOffline
  description: |+
    Setting the PersistMemoryOffline policy element to TRUE enables WHEA to persist memory offline decisions across computer reboots.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: PFAErrorThreshold
  description: |+
    The PFAErrorThreshold is the number of corrected errors that need to occur before a memory page in the PFA monitoring list is considered bad and will be taken offline.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: PFAPageCount
  description: |+
    The maximum size of the PFA monitoring list for pages that experience corrected memory errors.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: PFATimeout
  description: |+
    The number of seconds that WHEA monitors a memory page using PFA.
    WHEA starts monitoring a memory page when the page has its first corrected error.

    WHEA stops monitoring a memory page when one of the following events occurs:

    The monitoring interval exceeds the PfaTimeout value.

    or

    The number of detected errors exceeds the PfaErrorThreshold value.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
uid: WHEA.Set-WheaMemoryPolicy
name: Set-WheaMemoryPolicy
description: |-
  The **Set-WheaMemoryPolicy** cmdlet sets the elements of the WHEA (Windows Hardware Error Architecture) memory policy on the specified computer.
  WHEA receives memory errors, corrected and uncorrected, from the platform and implements a Predictive Failure Analysis (PFA) algorithm based on corrected errors.
  WHEA attempts to remove from the available system memory the pages that have uncorrected errors, or are predicted to fail based on corrected errors.
  The removal decisions can be persisted across reboots.
  You can change the WHEA decision criteria against memory errors by tuning the WHEA memory policy.
  These policy elements can be set independently of each other.
  The new policy element values take effect immediately.

  The following list specifies the WHEA memory policy elements:

  DisableOffline: Disable decisions to take memory offline based on corrected or uncorrected errors.

  DisablePFA: Disable predictive failure analysis (PFA) of memory pages based on the number of corrected errors reported in the page.

  PersistMemoryOffline: Persist the decisions to take memory offline across reboots.
  This element applies to both corrected and uncorrected errors.

  PFAPageCount: The maximum number of memory pages that WHEA monitors using PFA.

  PFAErrorThreshold: The number of errors that need to occur within the timeout period for the page to be candidate for removal.

  PFATimeout: The number of seconds before PFA takes a page out of the monitoring list.
metadata:
  external help file: Microsoft.Windows.Whea.WheaMemoryPolicy.dll-Help.xml
  Module Name: WHEA
  ms.date: 10/29/2017
  online version: https://docs.microsoft.com/powershell/module/whea/set-wheamemorypolicy?view=windowsserver2012r2-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  title: Set-WheaMemoryPolicy
