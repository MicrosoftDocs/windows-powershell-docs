### YamlMime:PowershellCmdlet
summary: |-
  Gets the permission level for one or more security principals on a specified GPO.
module: GroupPolicy
notes: |-
  * You can use the *DomainName* parameter to explicitly specify the domain for this cmdlet.

    If you do not explicitly specify the domain, the cmdlet uses the default domain.
  The default domain is the domain that is used to access network resources by the security context under which the current session is running.
  This domain is typically the domain of the user that is running the session.
  For example, the domain of the user who started the session by opening Windows PowerShell or the domain of a user that is specified in a runas command.
  However, computer startup and shutdown scripts run under the context of the LocalSystem account.
  The LocalSystem account is a built-in local account, and it accesses network resources under the context of the computer account.
  Therefore, when this cmdlet is run from a startup or shutdown script, the default domain is the domain to which the computer is joined.
inputs:
- name: <xref href="Microsoft.GroupPolicy.Gpo" data-throw-if-not-resolved="False" />
  description: |-
    You can pipe a GPO to this cmdlet for which to get the permission level.
    Collections that contain GPOs from different domains are not supported.
outputs:
- name: <xref href=" " data-throw-if-not-resolved="False" />
  description: |-
    This cmdlet returns an object that represents permissions for the specified security principal (user, group, or computer) on the GPO.
links:
- text: Set-GPPermission
  href: ./Set-GPPermission.yml
syntaxes:
- >-
  Get-GPPermission -Guid <Guid> [-TargetName <String>] [-TargetType <PermissionTrusteeType>]

   [-DomainName <String>] [-Server <String>] [-All] [<CommonParameters>]
- >-
  Get-GPPermission [-Name] <String> [-TargetName <String>] [-TargetType <PermissionTrusteeType>]

   [-DomainName <String>] [-Server <String>] [-All] [<CommonParameters>]
examples:
- title: 'Example 1: Get the permission level for group on the specified GPO'
  code: |-
    PS C:\> Get-GPPermission -Name "TestGpo" -TargetName "Domain Users" -TargetType Group 
    Trustee         : Domain Users 

    TrusteeType     : Group 

    PermissionLevel : GpoRead 

    Inherited       : False
  description: |-
    This command gets the permission level for the Domain Users group on the GPO named TestGpo.
  summary: ""
- title: 'Example 2: Get the permission level for group on the specified GPO with the specified GUID'
  code: |-
    PS C:\> Get-GPPermission -Domain "Sales.Contoso.com" -Server "DC1" -GUID fa4a9473-6e2a-4b87-ab78-175e68d97bde -TargetName "Domain Admins" -TargetType Group
  description: |-
    This command gets the permission level for the Domain Admins group on the GPO with the GUID fa4a9473-6e2a-4b78-175e68d97bde in the Sales.Contoso.com domain.
    The DC1.sales.contoso.com domain controller is contacted to complete the operation.

    If the domain of the user that is running the session (or, for startup and shutdown scripts, the computer) is different from the sales.contoso.com domain, a trust must exist between the two domains, or the command fails.
  summary: ""
- title: 'Example 3: Get the permission level for all security principals on the specified GPO'
  code: |-
    PS C:\> Get-GPPermission -Name "TestGPO" -All 

    Trustee     : Authenticated Users 
    TrusteeType : WellKnownGroup 
    Permission  : GpoApply 
    Inherited   : False 

    Trustee     : Domain Admins 
    TrusteeType : Group 
    Permission  : GpoEditDeleteModifySecurity 
    Inherited   : False 

    Trustee     : Enterprise Admins 
    TrusteeType : Group 
    Permission  : GpoEditDeleteModifySecurity 
    Inherited   : False 

    Trustee     : ENTERPRISE DOMAIN CONTROLLERS 
    TrusteeType : WellKnownGroup 
    Permission  : GpoRead 
    Inherited   : False 

    Trustee     : SYSTEM 
    TrusteeType : WellKnownGroup 
    Permission  : GpoEditDeleteModifySecurity 
    Inherited   : False
  description: |-
    This command gets the permission level for each security principal that has permissions on the GPO named TestGPO.
  summary: ""
- title: 'Example 4: Get the display name of each GPO for a specific permissions'
  code: |-
    PS C:\> Get-GPO -All | foreach-object { if($_ | Get-GPPermission -TargetName "contoso\Domain Admins" -TargetType Group -ErrorAction SilentlyContinue) {$_.DisplayName}} 

    Default Domain Policy 
    TestGPO-1 
    TestGPO-2 Default Domain Controllers Policy 
    Internet Security 
    TestGPO
  description: |-
    This command lists the display name of each GPO (in the domain) on which the specified security principal has permissions.

    First, Get-GPO is used to retrieve all the GPOs in the domain (Get-GPO -All).
    Then, the collection is piped into the foreach-object command.
    As each GPO is evaluated, it is piped into Get-GPPermissions.
    If a permission level is returned, the DisplayName property of the GPO is printed ($_.DisplayName).

    Note: The ErrorAction parameter is set to SilentlyContinue for Get-GPPermissions.
    This is because a non-terminating error occurs if the specified security principal does not have permissions on the GPO.
    Specifying the ErrorAction as SilentlyContinue prevents the error messages from being printed for GPOS on which the security principal does not have permissions.
    For more information about the ErrorAction parameter, see about_CommonParameters.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: All
  description: |+
    Indicates that the cmdlet gets the permission level for each user, group, or computer that has permissions on the GPO.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: DomainName
  description: |+
    Specifies the domain for this cmdlet.
    You must specify the fully qualified domain name (FQDN) of the domain. 

    For the **Get-GPPermission** cmdlet, the GPO for which to get the permission level must exist in this domain. 

    If you do not specify the *Domain* parameter, the domain of the user that is running the current session is used.
    If the cmdlet is being run from a computer startup or shutdown script, the domain of the computer is used.
    For more information, see the Notes section in the full Help. 

    If you specify a domain that is different from the domain of the user that is running the current session (or, for a startup or shutdown script, the computer), a trust must exist between that domain and the domain of the user or the computer.

    You can also refer to the *Server* parameter by its built-in alias, domain.
    For more information, see about_Aliases.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: Domain
  parameterValueGroup: ""
- type: <xref href="Guid" data-throw-if-not-resolved="False" />
  name: Guid
  isRequired: true
  description: |+
    Specifies the GPO from which to retrieve the permission level by its globally unique identifier (GUID).
    The GUID uniquely identifies the GPO.

    You can also refer to the *Guid* parameter by its built-in alias, id.
    For more information, see **about_Aliases**.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ID
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Name
  isRequired: true
  description: |+
    Specifies the GPO from which to retrieve the permission level by its display name.

    The display name is not guaranteed to be unique in the domain.
    If another GPO with the same display name exists in the domain an error occurs.
    You can use the *Guid* parameter to uniquely identify a GPO.

    You can also refer to the *Name* parameter by its built-in alias, displayname.
    For more information, see **about_Aliases**.

  defaultValue: None
  pipelineInput: true
  position: "0"
  aliases: DisplayName
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Server
  description: |+
    Specifies the name of the domain controller that this cmdlet contacts to complete the operation.
    You can specify either the fully qualified domain name (FQDN) or the host name.

    If you do not specify the name by using the *Server* parameter, the PDC emulator is contacted.

    You can also refer to the *Server* parameter by its built-in alias, dc.
    For more information, see **about_Aliases**.

  defaultValue: None
  position: Named
  aliases: DC
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: TargetName
  description: |+
    Specifies the name of the security principal for which to get the permission level.
    You can specify a user, a security group, or a computer.
    You can use either the domain-qualified name of the security principal (domain\account) or just its name.

    For instance, in the contoso.com domain, to specify:

    - The user "someuser", use "contoso\someuser" or "someuser".

    - The Domain Admins security group, use "contoso\Domain Admins" or "Domain Admins".

    - The computer "computer-01", use "contoso\computer-01" or "computer-01".

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="PermissionTrusteeType" data-throw-if-not-resolved="False" />
  name: TargetType
  description: |+
    The type of security principal for which to get the permission level.

    The acceptable values for this parameter are:

    - Computer

    - User

    - Group

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: Computer, User, Group
uid: GroupPolicy.Get-GPPermission
name: Get-GPPermission
description: |-
  The **Get-GPPermission** cmdlet gets the permission level for one or more security principals on the specified Group Policy Object (GPO).
  You can use the *TargetName* and *TargetType* parameters to specify a user, security group, or computer for which to get the permission level.
  You can use the *All* parameter to get the permission level for each security principal that includes: user, security group, or computer.
  This only works for a user, security group, or computer that has permissions on the GPO.
  You can specify the GPO by its display name or by its GUID.
metadata:
  description: Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell.
  external help file: Microsoft.GroupPolicy.Commands.dll-Help.xml
  Module Name: GroupPolicy
  ms.date: 12/20/2016
  online version: https://docs.microsoft.com/powershell/module/grouppolicy/get-gppermission?view=windowsserver2016-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  title: Get-GPPermission
