### YamlMime:PowershellCmdlet
summary: |-
  Create a virtual desktop template.
module: MultipointVdi
notes: ""
inputs:
- name: <xref href="None" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="None" data-throw-if-not-resolved="False" />
  description: ""
syntaxes:
- >-
  New-WmsVirtualDesktopTemplate -InputFilePath <String> [-VhdLocation <String>] -TemplatePrefix <String>

   -AdministratorUser <String> -AdministratorPassword <String> [-WhatIf] [-Confirm] [<CommonParameters>]
- >-
  New-WmsVirtualDesktopTemplate -InputFilePath <String> [-VhdLocation <String>] -TemplatePrefix <String>

   -AdministratorUser <String> -Domain <String> [-WhatIf] [-Confirm] [<CommonParameters>]
examples:
- title: 'Example 1: Create a virtual desktop template'
  code: |-
    PS C:\> New-WmsVirtualDesktopTemplate -InputFilePath "C:\Images\Windows10Enterprise.iso" -TemplatePrefix "MyVdiImage" -VhdLocation "C:\MultiPointVhdImages" -AdministratorUser "admin" -AdministratorPassword "password"
  description: |-
    This command creates a virtual desktop template that you can customize or use to generate station virtual desktops.
  summary: ""
parameters:
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: AdministratorPassword
  isRequired: true
  description: |+
    Specifies the password to assign to the Administrator account.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: AdministratorUser
  isRequired: true
  description: |+
    Specifies the name of a user to create in the virtual desktop template that has Administrator privileges.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: "False"
  position: Named
  aliases: cf
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Domain
  isRequired: true
  description: |+
    Specifies the name of the Active Directory domain for the virtual desktop.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: InputFilePath
  isRequired: true
  description: |+
    Specifies the full path of the input file to use for the virtual desktop template.
    Valid file types are .wim, .iso, or .vhd that contains the version of Windows to use as the guest operating system.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: TemplatePrefix
  isRequired: true
  description: |+
    Specifies the prefix to use for the name of the virtual machine template.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: VhdLocation
  description: |+
    Specifies the path to the location to store the desktop template and station .vhd files.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs.
    The cmdlet is not run.

  defaultValue: "False"
  position: Named
  aliases: wi
  parameterValueGroup: ""
uid: MultipointVdi.New-WmsVirtualDesktopTemplate
name: New-WmsVirtualDesktopTemplate
description: |-
  The **New-WmsVirtualDesktopTemplate** cmdlet shuts down all station virtual desktops based on an existing template of the same name.
  It then creates a virtual desktop template using the virtual hard disk created with Import-WmsVirtualDesktop.
  This virtual desktop is in either a workgroup or attached to the supplied domain, and has an administrative account with the specified user name and password.
metadata:
  description: Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell.
  external help file: MultiPointVdi.dll-Help.xml
  Module Name: MultipointVdi
  ms.date: 12/20/2016
  online version: https://docs.microsoft.com/powershell/module/multipointvdi/new-wmsvirtualdesktoptemplate?view=windowsserver2016-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  title: New-WmsVirtualDesktopTemplate
