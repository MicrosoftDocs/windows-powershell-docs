### YamlMime:PowershellCmdlet
summary: |-
  Returns an action object for file management jobs.
module: FileServerResourceManager
notes: ""
outputs:
- name: <xref href="Microsoft.Management.Infrastructure.CimInstance#MSFT_FSRMFMJAction" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: New-FsrmFileManagementJob
  href: ./New-FsrmFileManagementJob.yml
- text: Set-FsrmFileManagementJob
  href: ./Set-FsrmFileManagementJob.yml
syntaxes:
- >-
  New-FsrmFmjAction [-Type] <FmjActionTypeEnum> [-ExpirationFolder <String>] [-RmsFolderOwner]

   [-RmsFullControlUser <String[]>] [-RmsReadUser <String[]>] [-RmsWriteUser <String[]>] [-RmsTemplate <String>]

   [-Command <String>] [-WorkingDirectory <String>] [-CommandParameters <String>]

   [-SecurityLevel <FmjActionSecurityLevelEnum>] [-CimSession <CimSession[]>] [-ThrottleLimit <Int32>] [-AsJob]

   [-WhatIf] [-Confirm] [<CommonParameters>]
examples:
- title: 'Example 1: Create an action that expires files'
  code: |-
    PS C:\> New-FsrmFmjAction -Type Expiration -ExpirationFolder "C:\shares\expire01"
  description: |-
    This command returns an object that expires files to the path C:\shares\expire01.
  summary: ""
- title: 'Example 2: Create an action that encrypts files by using an RMS template'
  code: |-
    PS C:\> New-FsrmFmjAction -Type RMS -RmsTemplate "Contoso Confidential"
  description: |-
    This command returns an action object that encrypts a file to the Contoso Confidential RMS template.
    This command requires that an RMS template is configured on the RMS server named "Contoso Confidential".
  summary: ""
- title: 'Example 3: Create an action that encrypts files and assigns RMS permissions'
  code: |-
    PS C:\> New-FsrmFmjAction -Type RMS -RmsFullControlUser "admin@contoso.com" -RmsReadUser "AllStaff@contoso.com" -RmsWriteUser "AllFTE@contoso.com"
  description: |-
    This command returns an action object that encrypts a file so that the administrator account in contoso.com has full control of the file, the ALLFTE security group has edit rights to the file, and the ALLStaff group has read rights to the file.
  summary: ""
- title: 'Example 4: Create an action that runs a command'
  code: |-
    PS C:\> New-FsrmFmjAction -Type Custom -Command "C:\windows\system32\cmd.exe" -CommandParameters "echo [source file path] >> c:\log.txt"
  description: |-
    This command returns an action object that runs Cmd.exe and specifies the parameters for the command.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsJob
  description: |+
    Runs the cmdlet as a background job. Use this parameter to run commands that take a long time to complete. 

    The cmdlet immediately returns an object that represents the job and then displays the command prompt. 
    You can continue to work in the session while the job completes. 
    To manage the job, use the `*-Job` cmdlets. 
    To get the job results, use the [Receive-Job](https://go.microsoft.com/fwlink/?LinkID=113372) cmdlet. 

    For more information about Windows PowerShell background jobs, see [about_Jobs](https://go.microsoft.com/fwlink/?LinkID=113251).

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="CimSession" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: CimSession
  description: |+
    Runs the cmdlet in a remote session or on a remote computer.
    Enter a computer name or a session object, such as the output of a [New-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227967) or [Get-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227966) cmdlet.
    The default is the current session on the local computer.

  defaultValue: None
  position: Named
  aliases: Session
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Command
  description: |+
    Specifies the command that the action runs.
    If you specify a command, you must specify Custom for the *Type* parameter.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: CommandParameters
  description: |+
    Specifies the parameters that the action passes to the command when the action runs.
    If you specify parameters for a command, you must specify Custom for the *Type* parameter.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: "False"
  position: Named
  aliases: cf
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ExpirationFolder
  description: |+
    Specifies a path that the action uses to expire files.
    If you specify an expiration folder, you must specify Expiration for the *Type* parameter.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: RmsFolderOwner
  description: |+
    Indicates that the action adds the RMS FolderOwner to the Full Control list.
    If a FolderOwner is not available for a file, this setting has no effect.

    If you specify an RMS folder owner, you must specify RMS for the *Type* parameter.
    If you specify this parameter, do not specify the *RMSFullControlUser*, *RMSReadUser*, or *RMSWriteUser* parameters.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: RmsFullControlUser
  description: |+
    Specifies an array of email addresses to provide with full control to the Active Directory Rights Management Services (AD RMS) encryption.
    If you specify this cmdlet, you must specify RMS for the *Type* parameter.
    If you specify this parameter, do not specify the *RMSTemplate* parameter.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: RmsReadUser
  description: |+
    Specifies an array of addresses to provide with read permission to the Active Directory Rights Management Services (AD RMS) encryption.
    If you specify this cmdlet, you must specify RMS for the *Type* parameter.
    If you specify this parameter, do not specify the *RMSTemplate* parameter.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: RmsTemplate
  description: |+
    Specifies the name of the RMS template that the actions applies to files.
    If you specify an RMS template, you must specify RMS for the *Type* parameter.
    If you specify this parameter, do not specify the *RMSFullControlUser*, *RMSReadUser*, or *RMSWriteUser* parameters.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: RmsWriteUser
  description: |+
    Specifies an array of addresses to provide with write permission to the Active Directory Rights Management Services (AD RMS) encryption.
    If you specify this cmdlet, you must specify RMS for the *Type* parameter.
    If you specify this parameter, do not specify the *RMSTemplate* parameter.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="FmjActionSecurityLevelEnum" data-throw-if-not-resolved="False" />
  name: SecurityLevel
  description: |+
    Specifies the system account that the action uses to run the command that you specify in the *Command* parameter.
    If you specify this parameter, you must specify Custom for the *Type* parameter.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: None, NetworkService, LocalService, LocalSystem
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: ThrottleLimit
  description: |+
    Specifies the maximum number of concurrent operations that can be established to run the cmdlet.
    If this parameter is omitted or a value of `0` is entered, then Windows PowerShellÂ® calculates an optimum throttle limit for the cmdlet based on the number of CIM cmdlets that are running on the computer.
    The throttle limit applies only to the current cmdlet, not to the session or to the computer.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="FmjActionTypeEnum" data-throw-if-not-resolved="False" />
  name: Type
  isRequired: true
  description: |+
    Specifies the type of action that the file management job performs.
    The acceptable values for this parameter are:

    - Expiration
    - RMS
    - Custom

  defaultValue: None
  pipelineInput: true
  position: "1"
  aliases: ""
  parameterValueGroup: Expiration, Custom, Rms
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs.
    The cmdlet is not run.

  defaultValue: "False"
  position: Named
  aliases: wi
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: WorkingDirectory
  description: |+
    Specifies the working directory in which the program or script runs.
    You must specify a valid path to a folder.
    File Server Resource Manager (FSRM) does not support paths to remote computers.
    If you specify this parameter, you must specify Custom for the *Type* parameter.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
uid: FileServerResourceManager.New-FsrmFmjAction
name: New-FsrmFmjAction
description: |-
  The **New-FsrmFmjAction** cmdlet returns an object that you can use to create file management job actions.
  You can use the **FsrmFmjAction** object as input for the **New-FsrmFileManagementJob** cmdlet and the **Set-FsrmFileManagementJob** cmdlet.

  The **FsrmFmjAction** object defines one action of the file management job when the job acts on a file.
  This cmdlet supports the following actions: 

  - Expiration.
  Move the file to another location.
  - RMS.
  Encrypt the file (Rights Management Services).
  - Custom. 
  Run a command.
metadata:
  description: Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell.
  external help file: FsrmFmjAction.cdxml-help.xml
  Module Name: FileServerResourceManager
  ms.date: 12/20/2016
  online version: https://docs.microsoft.com/powershell/module/fileserverresourcemanager/new-fsrmfmjaction?view=windowsserver2019-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  title: New-FsrmFmjAction
