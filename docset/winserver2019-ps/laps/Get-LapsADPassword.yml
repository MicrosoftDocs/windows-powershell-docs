### YamlMime:PowershellCmdlet
summary: |-
  Queries Windows Local Administrator Password Solution (LAPS) credentials from Active Directory (AD)
  on a specified AD computer or domain controller object.
module: LAPS
notes: ""
inputs:
- name: <xref href="System.String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  description: ""
outputs:
- name: <xref href="System.Object" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Windows LAPS Overview
  href: https://go.microsoft.com/fwlink/?linkid=2233901
- text: Get started with Windows LAPS and Windows Server Active Directory
  href: https://go.microsoft.com/fwlink/?linkid=2233705
syntaxes:
- >-
  Get-LapsADPassword [-Credential <PSCredential>] [-DecryptionCredential <PSCredential>]

   [-IncludeHistory] [-AsPlainText] [-Identity] <String[]> [<CommonParameters>]
- >-
  Get-LapsADPassword [-Credential <PSCredential>] [-DecryptionCredential <PSCredential>]

   [-IncludeHistory] [-AsPlainText] [-Identity] <String[]> -Domain <String> [<CommonParameters>]
- >-
  Get-LapsADPassword [-Credential <PSCredential>] [-DecryptionCredential <PSCredential>]

   [-IncludeHistory] [-AsPlainText] [-Identity] <String[]> -DomainController <String>

   [<CommonParameters>]
- >-
  Get-LapsADPassword [-Credential <PSCredential>] [-DecryptionCredential <PSCredential>]

   [-IncludeHistory] [-AsPlainText] -Port <Int32> [-Identity] <String[]> [-DomainController <String>]

   [<CommonParameters>]
- >-
  Get-LapsADPassword [-IncludeHistory] [-AsPlainText] [-RecoveryMode] [-Identity] <String[]>

   [<CommonParameters>]
- >-
  Get-LapsADPassword [-IncludeHistory] [-AsPlainText] [-RecoveryMode] -Port <Int32>

   [-Identity] <String[]> [<CommonParameters>]
examples:
- title: Example 1
  code: |-
    Get-LapsADPassword LAPSCLIENT

    ComputerName        : LAPSCLIENT
    DistinguishedName   : CN=LAPSCLIENT,OU=LapsTestOU,DC=laps,DC=com
    Account             : Administrator
    Password            : System.Security.SecureString
    PasswordUpdateTime  : 4/9/2023 10:03:41 AM
    ExpirationTimestamp : 4/14/2023 10:03:41 AM
    Source              : CleartextPassword
    DecryptionStatus    : NotApplicable
    AuthorizedDecryptor : NotApplicable
  description: |-
    This example demonstrates querying the current LAPS password for the `LAPSCLIENT` computer in the
    current domain. The password was stored in AD in clear-text form and didn't require decryption. The
    password was returned wrapped in a **SecureString** object.
  summary: ""
- title: Example 2
  code: |-
    Get-LapsADPassword -Identity LAPSCLIENT -DomainController lapsDC -AsPlainText

    ComputerName        : LAPSCLIENT
    DistinguishedName   : CN=LAPSCLIENT,OU=LapsTestOU,DC=laps,DC=com
    Account             : Administrator
    Password            : k8P]Xl5T-ky!aj4s21el3S#.x44!e{8+,{L!M
    PasswordUpdateTime  : 4/9/2023 10:03:41 AM
    ExpirationTimestamp : 4/14/2023 10:03:41 AM
    Source              : CleartextPassword
    DecryptionStatus    : NotApplicable
    AuthorizedDecryptor : NotApplicable
  description: |-
    This example demonstrates querying the current LAPS password on a specific domain controller
    (`lapsDC`), for the `LAPSCLIENT` computer, requesting that the password be displayed in clear-text
    form. The password was stored in AD in clear-text form and didn't require decryption. The password
    was returned in clear-text form.
  summary: ""
- title: Example 3
  code: |-
    Get-LapsADPassword -Identity LAPSCLIENT2 -Domain laps.com -AsPlainText -IncludeHistory

    ComputerName        : LAPSCLIENT2
    DistinguishedName   : CN=LAPSCLIENT2,OU=LapsTestEncryptedOU,DC=laps,DC=com
    Account             : Administrator
    Password            : q64!7KI3BOe/&S%buM0nBaW{B]261zN5L0{;{
    PasswordUpdateTime  : 4/9/2023 9:39:38 AM
    ExpirationTimestamp : 4/14/2023 9:39:38 AM
    Source              : EncryptedPassword
    DecryptionStatus    : Success
    AuthorizedDecryptor : LAPS\LAPS Admins

    ComputerName        : LAPSCLIENT2
    DistinguishedName   : CN=LAPSCLIENT2,OU=LapsTestEncryptedOU,DC=laps,DC=com
    Account             : Administrator
    Password            : O{P61q6bu(3kZ6&#p2y.&F$cWd;0dm8!]Wl5j
    PasswordUpdateTime  : 4/9/2023 9:38:10 AM
    ExpirationTimestamp :
    Source              : EncryptedPasswordHistory
    DecryptionStatus    : Success
    AuthorizedDecryptor : LAPS\LAPS Admins
  description: |-
    This example demonstrates querying the current LAPS password for the `LAPSCLIENT2` computer, in a
    specific AD domain (`laps.com`), requesting that the password be displayed in
    clear-text form. The password was stored in AD in encrypted form and was successfully
    decrypted.

    > [!NOTE]
    > **ExpirationTimestamp** is always empty for any older LAPS passwords returned.
  summary: ""
- title: Example 4
  code: |-
    Get-LapsADPassword -Identity lapsDC.laps.com -AsPlainText

    ComputerName        : LAPSDC
    DistinguishedName   : CN=LAPSDC,OU=Domain Controllers,DC=laps,DC=com
    Account             : Administrator
    Password            : 118y$rsw.3y58yG]on$Hii
    PasswordUpdateTime  : 4/9/2023 10:17:51 AM
    ExpirationTimestamp : 4/19/2023 10:17:51 AM
    Source              : EncryptedDSRMPassword
    DecryptionStatus    : Success
    AuthorizedDecryptor : LAPS\Domain Admins
  description: |-
    This example demonstrates querying the current LAPS password for the `lapsDC.laps.com` domain
    controller, requesting that the password be displayed in clear-text form. The password was stored in
    AD in encrypted form and was successfully decrypted.
  summary: ""
- title: Example 5
  code: |-
    Get-LapsADPassword LAPSDC

    ComputerName        : LAPSDC
    DistinguishedName   : CN=LAPSDC,OU=Domain Controllers,DC=laps,DC=com
    Account             :
    Password            :
    PasswordUpdateTime  : 4/9/2023 10:17:51 AM
    ExpirationTimestamp : 4/19/2023 10:17:51 AM
    Source              : EncryptedDSRMPassword
    DecryptionStatus    : Unauthorized
    AuthorizedDecryptor : LAPS\Domain Admins
  description: |-
    This example demonstrates querying the current LAPS password for the `LAPSDC` domain controller when
    the user doesn't have permissions to decrypt the LAPS DSRM password.
  summary: ""
- title: Example 6
  code: |-
    Get-LapsADPassword LAPSLEGACYCLIENT -AsPlainText

    ComputerName        : LAPSLEGACYCLIENT
    DistinguishedName   : CN=LAPSLEGACYCLIENT,OU=LegacyLapsOU,DC=laps,DC=com
    Account             :
    Password            : Z#x}&7BluHf3{r+C218
    PasswordUpdateTime  :
    ExpirationTimestamp : 5/14/2023 1:55:39 PM
    Source              : LegacyLapsCleartextPassword
    DecryptionStatus    : NotApplicable
    AuthorizedDecryptor : NotApplicable
  description: |-
    This example demonstrates querying the current LAPS password for the 'LAPSLEGACYCLIENT' machine
    which is currently running in legacy LAPS emulation mode.

    > [!NOTE]
    > When querying legacy LAPS-style passwords, the **Account** and **PasswordUpdateTime** fields are
    > always unavailable.
  summary: ""
- title: Example 7
  code: |-
    Get-LapsADPassword -Identity LAPSCLIENT -Port 50000 -AsPlainText

    ComputerName        : LAPSCLIENT
    DistinguishedName   : CN=LAPSCLIENT,OU=LapsTestOU,DC=laps,DC=com
    Account             : Administrator
    Password            : H6UycL[vj#zzTNVpS//G2{j&t9aO}k[K5l4)X
    PasswordUpdateTime  : 4/15/2023 6:51:45 AM
    ExpirationTimestamp : 4/20/2023 6:51:45 AM
    Source              : CleartextPassword
    DecryptionStatus    : NotApplicable
    AuthorizedDecryptor : NotApplicable
  description: |-
    This example demonstrates querying an AD Snapshot browser instance for the current LAPS password for
    the `LAPSCLIENT` machine. This example assumes that that the snapshot browser has been previously
    started on the local machine listening on an LDAP port of `50000`.
  summary: ""
parameters:
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsPlainText
  description: |+
    Specify this parameter to return the LAPS passwords in clear-text format. The default behavior is to
    return the LAPS passwords wrapped in a .NET **SecureString** object.

    > [!IMPORTANT]
    > Using this parameter exposes the returned clear-text password to casual viewing and may pose a
    > security risk. This parameter should be used with caution and only in support or testing
    > situations.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.PSCredential" data-throw-if-not-resolved="False" />
  name: Credential
  description: |+
    Specifies a set of credentials to use when querying AD for the LAPS credentials. If not specified,
    the current user's credentials are used.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.PSCredential" data-throw-if-not-resolved="False" />
  name: DecryptionCredential
  description: |+
    Specifies a set of credentials to use when decrypting encrypted LAPS credentials. If not specified,
    the current user's credentials are used.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Domain
  isRequired: true
  description: |+
    Specifies the name of the domain to connect to.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: DomainController
  isRequired: true
  description: |+
    Specifies the name of the domain controller to connect to, or the remote server on which an AD
    Snapshot Browser is running.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: Identity
  isRequired: true
  description: |+
    Specifies the name of the computer or domain controller object to retrieve LAPS credentials from.

    This parameter accepts several different name formats that influence the criteria used when
    searching AD for the target device. The supported name formats are as follows:

    - distinguishedName (begins with a `CN=`)
    - samAccountName (begins with a '$")
    - dnsHostName (contains at least one '.' character)
    - name (for all other inputs)

  defaultValue: None
  pipelineInput: true
  position: "0"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: IncludeHistory
  description: |+
    Specifies that any older LAPS credentials on the computer object should also be displayed.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Nullable`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="System.Int32" data-throw-if-not-resolved="False" /><span>]</span>
  name: Port
  isRequired: true
  description: |+
    Specifies the AD Snapshot Browser port to connect to.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: RecoveryMode
  isRequired: true
  description: |+
    This parameter provides a last-ditch option when it's no longer possible to decrypt a given LAPS
    credential via the normal mechanisms. For example, this might be necessary if a LAPS credential was
    encrypted against a group that has since been deleted.

    >[!IMPORTANT]
    > When specifying this parameter, you must be logged-in locally as a Domain Administrator on a
    > writable domain controller.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
uid: LAPS.Get-LapsADPassword
name: Get-LapsADPassword
description: |-
  The `Get-LapsADPassword` cmdlet allows administrators to retrieve LAPS passwords and password
  history for an Active Directory computer or domain controller object. Depending on policy
  configuration, LAPS passwords may be stored in either clear-text form or encrypted form. The
  `Get-LapsADPassword` cmdlet automatically decrypts encrypted passwords.

  The `Get-LapsADPassword` cmdlet may also be used to connect to a mounted AD
  snapshot.

  The **Verbose** parameter may be used to get additional information about the cmdlet's operation.
metadata:
  description: Queries Windows Local Administrator Password Solution (LAPS) credentials from Active Directory (AD) on a specified AD computer or domain controller object.
  external help file: lapspsh.dll-Help.xml
  Module Name: LAPS
  online version: https://learn.microsoft.com/powershell/module/laps/get-lapsadpassword?view=windowsserver2019-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  Locale: en-US
  ms.date: 04/10/2023
  title: Get-LapsADPassword
