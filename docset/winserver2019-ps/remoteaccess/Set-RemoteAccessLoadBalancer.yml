### YamlMime:PowershellCmdlet
summary: |-
  Configures load balancing on the Remote Access (RA) server or the cluster server.
module: RemoteAccess
notes: ""
inputs:
- name: <xref href="None" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="Microsoft.Management.Infrastructure.CimInstance#RemoteAccessLoadBalancer" data-throw-if-not-resolved="False" />
  description: "The `Microsoft.Management.Infrastructure.CimInstance` object is a wrapper class that displays Windows Management Instrumentation (WMI) objects.\r\nThe path after the pound sign (`#`) provides the namespace and class name for the underlying WMI object.\r\n                         \r\nThe RemoteAccessLoadBalancer object consists of the following properties: \r\n                         \r\nThe list of nodes in the cluster and the following properties for each node: \r\n                         \r\n -- IPv4 or IPv6 address or host name of the node. \r\n                         \r\n -- The load balancing status of each node. \r\n                         \r\n -- IPv4 address ranges configured on each node for the VPN static pool address assignment. \r\n                         \r\n -- Status of third party load balancer: Enabled or Disabled. \r\n                         \r\n -- The list of internet virtual IP addresses. \r\n                         \r\n -- The list of internal virtual IP addresses."
links:
- text: Get-RemoteAccessLoadBalancer
  href: ./Get-RemoteAccessLoadBalancer.yml
- text: Remove-RemoteAccessLoadBalancerNode
  href: ./Remove-RemoteAccessLoadBalancerNode.yml
- text: Set-DAServer
  href: ./Set-DAServer.yml
- text: Set-RemoteAccessLoadBalancer
  href: ./Set-RemoteAccessLoadBalancer.yml
syntaxes:
- >-
  Set-RemoteAccessLoadBalancer [-ComputerName <String>] [-PassThru] [-UseThirdPartyLoadBalancer]

   [-InternetDedicatedIPAddress] <String[]> [-InternalDedicatedIPAddress <String[]>]

   [-InternetVirtualIPAddress <String[]>] [-InternalVirtualIPAddress <String[]>] [-CimSession <CimSession[]>]

   [-ThrottleLimit <Int32>] [-AsJob] [-WhatIf] [-Confirm] [<CommonParameters>]
- >-
  Set-RemoteAccessLoadBalancer [-Disable] [-ComputerName <String>] [-Force] [-PassThru]

   [-CimSession <CimSession[]>] [-ThrottleLimit <Int32>] [-AsJob] [-WhatIf] [-Confirm] [<CommonParameters>]
- >-
  Set-RemoteAccessLoadBalancer [-ComputerName <String>] [-PassThru] -ThirdPartyLoadBalancer <String>

   [-CimSession <CimSession[]>] [-ThrottleLimit <Int32>] [-AsJob] [-WhatIf] [-Confirm] [<CommonParameters>]
examples:
- title: EXAMPLE 1
  code: |-
    PS C:\>Set-RemoteAccessLoadBalancer -InternetDedicatedIPAddress "131.107.0.20/255.255.255.0" -InternalDedicatedIPAddress @("3ffe::2/64","10.0.0.2/255.255.255.0") -InternetVirtualIPAddress @("131.107.0.5/255.255.255.0","131.107.0.15/255.255.255.0") -InternalVirtualIPAddress @("3ffe::5/64","10.0.0.5/255.255.255.0") -PassThru
    NlbNodeStatus            : edge2.corp.contoso.com 
    ThirdPartyLoadBalancer   : Disabled 
    InternetVirtualIPAddress : {131.107.0.5/255.255.255.0, 131.107.0.15/255.255.255.0} 
    InternalVirtualIPAddress : {3ffe::5/64, 10.0.0.5/255.255.255.0}
  description: |-
    This example sets the NLB settings with Windows load balancer in edge topology.
    Therefore the Internet address of the existing DA server located at 131.107.0.2 is promoted to be the internet virtual IP address of the load balanced cluster.
    In this way, clients can still connect to the same external IP that they connected to without bothering about load balancing.
  summary: ""
- title: EXAMPLE 2
  code: |-
    PS C:\>Set-RemoteAccessLoadBalancer -InternetDedicatedIPAddress @("10.0.0.2/255.255.255.0","3ffe::2/64") -InternetVirtualIPAddress @("10.0.0.5/255.255.255.0", "3ffe::5/64") -PassThru
    NlbNodeStatus            : edge1.corp.contoso.com 
    ThirdPartyLoadBalancer    : Disabled 
    InternetVirtualIPAddress    : {10.0.0.5/255.255.255.0, 3ffe::5/64} 
    InternalVirtualIPAddress    :
  description: |-
    This example sets the NLB settings with Windows load balancer in single network adapter topology.
    The corporate network is IPv4 and IPv6 enabled and therefore an array containing the IPv4 and IPv6 addresses for internet VIP and DIP is specified.
    Since the DA server is behind an edge device, the internet VIPs and DIPs contain corporate network addresses.
  summary: ""
- title: EXAMPLE 3
  code: |-
    PS C:\>Set-RemoteAccessLoadBalancer -InternetDedicatedIPAddress "131.107.0.20/255.255.255.0" -InternalDedicatedIPAddress @("3ffe::2/64","10.0.0.2/255.255.255.0") -InternetVirtualIPAddress @("131.107.0.5/255.255.255.0","131.107.0.15/255.255.255.0") -InternalVirtualIPAddress @("3ffe::5/64","10.0.0.5/255.255.255.0") -PassThru -UseThirdPartyLoadBalancer
    NlbNodeStatus            : edge2.corp.contoso.com 
    ThirdPartyLoadBalancer   : Enabled 
    InternetVirtualIPAddress : {131.107.0.5/255.255.255.0, 131.107.0.15/255.255.255.0} 
    InternalVirtualIPAddress : {3ffe::5/64, 10.0.0.5/255.255.255.0}
  description: |-
    This example sets the NLB settings using third party load balancer.
    The administrator will still have to manually configure the NLB device.
  summary: ""
- title: EXAMPLE 4
  code: |-
    PS C:\>Set-RemoteAccessLoadBalancer -ThirdPartyLoadBalancer Disabled -PassThru
    NlbNodeStatus            : edge2.corp.contoso.com 
    ThirdPartyLoadBalancer   : Disabled 
    InternetVirtualIPAddress : {131.107.0.5/255.255.255.0, 131.107.0.15/255.255.255.0} 
    InternalVirtualIPAddress : {3ffe::5/64, 10.0.0.5/255.255.255.0}
  description: |-
    This example disables the external load balancer for a Windows load balanced cluster.
    The computer will now use the Windows load balancer to balance the load between servers.
  summary: ""
- title: EXAMPLE 5
  code: |-
    PS C:\>Set-RemoteAccessLoadBalancer -ThirdPartyLoadBalancer Enabled -PassThru
    NlbNodeStatus            : edge2.corp.contoso.com 
    ThirdPartyLoadBalancer   : Enabled 
    InternetVirtualIPAddress : {131.107.0.5/255.255.255.0, 131.107.0.15/255.255.255.0} 
    InternalVirtualIPAddress : {3ffe::5/64, 10.0.0.5/255.255.255.0}
  description: |-
    This example enables the external load balancer for a Windows load balanced cluster.
    The computer will now use the external load balancer to balance the load between servers.
  summary: ""
- title: EXAMPLE 6
  code: "PS C:\\>Set-RemoteAccessLoadBalancer -Disable\r\nConfirm \r\nDisabling loadbalancing will disable cluster configuration. Do you want to continue? \r\n \r\n[Y] Yes  [N] No  [S] Suspend  [?] Help (default is ꞌYꞌ): Y"
  description: |-
    This example removes the NLB configuration.
    DA configuration is also removed from all the servers except the one on which the cmdlet is run.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsJob
  description: |+
    Runs the cmdlet as a background job. Use this parameter to run commands that take a long time to complete.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="CimSession" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: CimSession
  description: |+
    Runs the cmdlet in a remote session or on a remote computer.
    Enter a computer name or a session object, such as the output of a [New-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227967) or [Get-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227966) cmdlet.
    The default is the current session on the local computer.

  defaultValue: None
  position: Named
  aliases: Session
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ComputerName
  description: |+
    Specifies the IPv4 or IPv6 address, or host name, of the server on which the cmdlet runs.
    If this parameter is specified, then the server is added to the load balanced cluster.

  defaultValue: None
  position: Named
  aliases: Cn
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: "False"
  position: Named
  aliases: cf
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Disable
  isRequired: true
  description: |+
    Disables load balancing.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Force
  description: |+
    Forces the command to run without asking for user confirmation.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: InternalDedicatedIPAddress
  description: "Specifies one or more IP addresses with subnet masks that will be used as the dedicated IP addresses (DIPs) for load balancing on the internal network adapter. \r\n                         \r\nSpecify the IPv4 address and subnet in the format IP_ADDR/SUBNET.\r\nFor IPv6 specify the prefix length along with the IP address.\r\n\r\n"
  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: InternalVirtualIPAddress
  description: "Specifies one or more IP addresses with subnet masks that will be used as the virtual IP addresses (VIPs) for load balancing on the internal network adapter.\r\nThese are usually the current IP addresses on the internal adapter of the server on which the cmdlet is run. \r\n                         \r\nSpecify the IPv4 address and subnet in the format IP_ADDR/SUBNET.\r\nFor IPv6 specify the prefix length along with the IP address. \r\n                         \r\nIf ISATAP is deployed in the internal network, then at least one of the IP addresses specified in this parameter should be present in the ISATAP name entry in DNS. \r\n                         \r\nThe NLS should resolve to at least one of the VIPs.\r\n\r\n"
  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: InternetDedicatedIPAddress
  isRequired: true
  description: "Specifies one or more IPv4 or IPv6 addresses with subnet masks that will be used as the DIPs for load balancing on the external network adapter. \r\n                         \r\nSpecify the IPv4 address and subnet in the format IP_ADDR/SUBNET.\r\nFor IPv6 specify the prefix length along with the IP address.\r\n\r\n"
  defaultValue: None
  pipelineInput: true
  position: "1"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: InternetVirtualIPAddress
  description: "Specifies one or more IP addresses with subnet masks that will be used as the VIPs for load balancing on the external network adapter and should include the IPsec tunnel endpoint IP addresses on the external adapter. \r\n                         \r\nSpecify the IPv4 address and subnet in the format IP_ADDR/SUBNET.\r\nFor IPv6 specify the prefix length along with the IP address.\r\nIf ISATAP is deployed in the internal network, then at least one of the IP addresses specified in the parameter should be present in the ISATAP name entry in DNS.\r\nIf the external adapter VIP addresses are not specified, then by default the IPsec tunnel endpoint IP addresses on the external adapter are used.\r\n\r\n"
  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: PassThru
  description: |+
    Returns an object representing the item with which you are working.
    By default, this cmdlet does not generate any output.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ThirdPartyLoadBalancer
  isRequired: true
  description: "Specifies the enabled state of a third-party external load balancer.\r\nThe acceptable values for this parameter are:\r\n                         \r\n -- Enabled. \r\n                         \r\n -- Disabled. \r\nNote: If external load balancing is Enabled and Teredo has been deployed, then all the external DIPs must be consecutive addresses.\r\n\r\n"
  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: Enabled, Disabled
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: ThrottleLimit
  description: |+
    Specifies the maximum number of concurrent operations that can be established to run the cmdlet.
    If this parameter is omitted or a value of `0` is entered, then Windows PowerShell® calculates an optimum throttle limit for the cmdlet based on the number of CIM cmdlets that are running on the computer.
    The throttle limit applies only to the current cmdlet, not to the session or to the computer.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: UseThirdPartyLoadBalancer
  description: |+
    Enables use of a third-party external load balancer for cluster traffic. 
    Note: If external load balancing is enabled and Teredo has been deployed, then all the external DIPs must be consecutive addresses.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs.
    The cmdlet is not run.

  defaultValue: "False"
  position: Named
  aliases: wi
  parameterValueGroup: ""
uid: RemoteAccess.Set-RemoteAccessLoadBalancer
name: Set-RemoteAccessLoadBalancer
description: "The **Set-RemoteAccessLoadBalancer** cmdlet configures load balancing for a Remote Access (RA) deployment. \r\n                       \r\n -- The **InternalDedicatedIPAddress** and **InternalVirtualIPAddress** parameters must be specified unless the server is configured with a single network adapter only. \r\n                       \r\n -- If the use of a third-party external load balancer is Enabled, then Windows network load balancing (NLB) is automatically Disabled, otherwise NLB is Enabled. \r\n                       \r\n -- When load balancing is enabled the IP-HTTPS prefix and the IPv6 prefix for VPN must be of length 59 bits.\r\nThe IP-HTTPS prefix can be configured using the **ClientIPv6Prefix** parameter in the Set-DAServer cmdlet. \r\n                       \r\n -- All servers in the cluster share the same RA configuration.\r\n\r\nNote: If Windows load balancing is used then the Network Load Balancing role (NLB) needs to be installed prior to using this cmdlet."
metadata:
  description: Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell.
  external help file: PS_RemoteAccessLoadBalancer_v1.0.0.cdxml-help.xml
  Module Name: RemoteAccess
  ms.date: 12/20/2016
  online version: https://docs.microsoft.com/powershell/module/remoteaccess/set-remoteaccessloadbalancer?view=windowsserver2019-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  title: Set-RemoteAccessLoadBalancer
