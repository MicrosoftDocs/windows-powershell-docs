### YamlMime:PowershellCmdlet
summary: |-
  Removes exclusions or default actions.
module: Defender
notes: ""
links:
- text: Add-MpPreference
  href: ./Add-MpPreference.yml
- text: Get-MpPreference
  href: ./Get-MpPreference.yml
- text: Set-MpPreference
  href: ./Set-MpPreference.yml
syntaxes:
- >-
  Remove-MpPreference [-ExclusionPath <String[]>] [-ExclusionExtension <String[]>] [-ExclusionProcess <String[]>]

   [-ThreatIDDefaultAction_Ids <Int64[]>] [-UnknownThreatDefaultAction] [-LowThreatDefaultAction]

   [-AttackSurfaceReductionOnlyExclusions <String>]

   [-ModerateThreatDefaultAction] [-HighThreatDefaultAction] [-SevereThreatDefaultAction] [-Force]

   [-CimSession <CimSession[]>] [-ThrottleLimit <Int32>] [-AsJob] [<CommonParameters>]
examples:
- title: 'Example 1: Remove a folder from the exclusion list'
  code: |-
    PS C:\> Remove-MpPreference -ExclusionPath "C:\Temp"
  description: |-
    This command removes the folder C:\Temp from the exclusion list.
  summary: ""
- title: 'Example 2:'
  code: |-
    PS C:\> Remove-MpPreference -AttackSurfaceReductionOnlyExclusions "C:\Windows\App.exe"
  description: |-
    This command will exclude only that specific file app.exe in that specific folder.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsJob
  description: |+
    Runs the cmdlet as a background job. Use this parameter to run commands that take a long time to complete. 

    The cmdlet immediately returns an object that represents the job and then displays the command prompt. 
    You can continue to work in the session while the job completes. 
    To manage the job, use the `*-Job` cmdlets. 
    To get the job results, use the [Receive-Job](https://go.microsoft.com/fwlink/?LinkID=113372) cmdlet. 

    For more information about Windows PowerShell background jobs, see [about_Jobs](https://go.microsoft.com/fwlink/?LinkID=113251).

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: AttackSurfaceReductionOnlyExclusions
  description: |+
    Exclude files and paths from Attack Surface Reduction (ASR) rules. Specify the folders or files and resources that should be excluded from ASR rules. Enter a folder path or a fully qualified resource name. For example, ""C:\Windows"" will exclude all files in that directory. ""C:\Windows\App.exe"" will exclude only that specific file in that specific folder.

    For more information about excluding files and folders from [ASR rules](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/enable-attack-surface-reduction#exclude-files-and-folders-from-asr-rules).

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="CimSession" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: CimSession
  description: |+
    Runs the cmdlet in a remote session or on a remote computer. 
    Enter a computer name or a session object, such as the output of a [New-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227967) or [Get-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227966) cmdlet. 
    The default is the current session on the local computer.

  defaultValue: None
  position: Named
  aliases: Session
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: ExclusionExtension
  description: |+
    Specifies an array of file name extensions, such as obj or lib, to exclude from scheduled, custom, and real-time scanning.
    This cmdlet removes the exclusions that you specify.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: ExclusionPath
  description: |+
    Specifies an array of file paths to exclude from scheduled and real-time scanning.
    This cmdlet removes the exclusions that you specify.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: ExclusionProcess
  description: |+
    Specifies an array of processes, as paths to process images.
    This cmdlet removes exclusions of files opened by the processes that you specify.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Force
  description: |+
    Forces the command to run without asking for user confirmation.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: HighThreatDefaultAction
  description: |+
    Indicates that this cmdlet removes the automatic remediation action specified for the high threat alert level.

  defaultValue: None
  position: Named
  aliases: htdefac
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: LowThreatDefaultAction
  description: |+
    Indicates that this cmdlet removes the automatic remediation action specified for the low threat alert level.

  defaultValue: None
  position: Named
  aliases: ltdefac
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: ModerateThreatDefaultAction
  description: |+
    Indicates that this cmdlet removes the automatic remediation action specified for the moderate threat alert level.

  defaultValue: None
  position: Named
  aliases: mtdefac
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: SevereThreatDefaultAction
  description: |+
    Indicates that this cmdlet removes the automatic remediation action specified for the severe threat alert level.

  defaultValue: None
  position: Named
  aliases: stdefac
  parameterValueGroup: ""
- type: <xref href="Int64" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: ThreatIDDefaultAction_Ids
  description: |+
    Specifies an array of threat IDs.
    This cmdlet removes the default actions for the threat IDs that you specify.

  defaultValue: None
  position: Named
  aliases: tiddefaci
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: ThrottleLimit
  description: |+
    Specifies the maximum number of concurrent operations that can be established to run the cmdlet.
    If this parameter is omitted or a value of `0` is entered, then Windows PowerShellÂ® calculates an optimum throttle limit for the cmdlet based on the number of CIM cmdlets that are running on the computer.
    The throttle limit applies only to the current cmdlet, not to the session or to the computer.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: UnknownThreatDefaultAction
  description: |+
    Indicates that this cmdlet removes the automatic remediation action specified for the unknown threat alert level.

  defaultValue: None
  position: Named
  aliases: unktdefac
  parameterValueGroup: ""
uid: Defender.Remove-MpPreference
name: Remove-MpPreference
description: |-
  The **Remove-MpPreference** cmdlet removes exclusions for file name extensions, paths, and processes, or default actions for high, moderate, and low threats.
  If you attempt to remove an exclusion that is not in the list, this cmdlet reports the error.
metadata:
  description: Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell.
  external help file: MSFT_MpPreference.cdxml-help.xml
  Module Name: Defender
  ms.date: 12/20/2016
  online version: https://docs.microsoft.com/powershell/module/defender/remove-mppreference?view=windowsserver2022-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  title: Remove-MpPreference
