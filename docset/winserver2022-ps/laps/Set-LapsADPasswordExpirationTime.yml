### YamlMime:PowershellCmdlet
summary: |-
  Sets the Windows Local Administrator Password Solution (LAPS) password expiration timestamp on an
  Active Directory (AD) computer or domain controller object.
module: LAPS
notes: ""
inputs:
- name: <xref href="System.String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  description: ""
outputs:
- name: <xref href="System.Object" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Windows LAPS Overview
  href: https://go.microsoft.com/fwlink/?linkid=2233901
syntaxes:
- >-
  Set-LapsADPasswordExpirationTime [-Credential <PSCredential>] -Identity <String[]>

   [-WhenEffective <DateTime>] [-Domain <String>] [-DomainController <String>] [<CommonParameters>]
examples:
- title: Example 1
  code: |-
    Set-LapsADPasswordExpirationTime -Identity lapsClient

    DistinguishedName                           Status
    -----------------                           ------
    CN=LAPSCLIENT,OU=LapsTestOU,DC=laps,DC=com  PasswordReset
  description: |-
    This example shows setting the LAPS password expiration time to the current time, which expires the
    password immediately.
  summary: ""
- title: Example 2
  code: |-
    Set-LapsADPasswordExpirationTime -Identity lapsClient -WhenEffective (Get-Date -Date "07/04/2023 13:00:00")

    DistinguishedName                           Status
    -----------------                           ------
    CN=LAPSCLIENT,OU=LapsTestOU,DC=laps,DC=com  PasswordReset
  description: |-
    This examples show setting the LAPS password expiration time to a specific date.
  summary: ""
- title: Example 3
  code: |-
    Set-LapsADPasswordExpirationTime -Identity lapsClient -WhenEffective (DateTime::Now.AddDays(1))

    DistinguishedName                           Status
    -----------------                           ------
    CN=LAPSCLIENT,OU=LapsTestOU,DC=laps,DC=com  PasswordReset
  description: |-
    This examples show setting the LAPS password expiration time to one day in the future.
  summary: ""
parameters:
- type: <xref href="System.Management.Automation.PSCredential" data-throw-if-not-resolved="False" />
  name: Credential
  description: |+
    Specifies the credentials to use when updating AD. If not specified, the current user's credentials
    are used.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Domain
  description: |+
    Specifies the name of the domain to connect to.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: DomainController
  description: |+
    Specifies the name of the domain controller to connect to.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: Identity
  isRequired: true
  description: |+
    Specifies the name of the computer or domain controller object to set the LAPS password expiration
    time on.

    This parameter accepts several different name formats that influence the criteria used when
    searching AD for the target device. The supported name formats are as follows:

    - distinguishedName (begins with a `CN=`)
    - samAccountName (begins with a `$`)
    - dnsHostName (contains at least one `.` character)
    - name (for all other inputs)

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.DateTime" data-throw-if-not-resolved="False" />
  name: WhenEffective
  description: |+
    Specifies the new LAPS password expiration time. If not specified, the current time is used, which
    expires the password is immediately.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
uid: LAPS.Set-LapsADPasswordExpirationTime
name: Set-LapsADPasswordExpirationTime
description: |-
  The `Set-LapsADPasswordExpirationTime` cmdlet is used by administrators to configure the LAPS
  password expiration time on an AD computer or domain controller object.

  > [!TIP]
  > Running this cmdlet sets the LAPS password expiration time on the AD computer or domain controller
  > object, but the new expiration time isn't honored until the next time the target device executes a
  > LAPS policy processing cycle.
metadata:
  description: Sets the Windows Local Administrator Password Solution (LAPS) password expiration timestamp on an Active Directory (AD) computer or domain controller object.
  external help file: lapspsh.dll-Help.xml
  Module Name: LAPS
  online version: https://learn.microsoft.com/powershell/module/laps/set-lapsadpasswordexpirationtime?view=windowsserver2022-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  Locale: en-US
  ms.date: 04/10/2023
  title: Set-LapsADPasswordExpirationTime
