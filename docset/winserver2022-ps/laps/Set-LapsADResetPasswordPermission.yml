### YamlMime:PowershellCmdlet
summary: |-
  Configures security on an Active Directory (AD) Organizational Unit (OU) to grant specific users or
  groups permission to set the Windows Local Administrator Password Solution (LAPS) password
  expiration time.
module: LAPS
notes: ""
inputs:
- name: <xref href="System.String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  description: ""
outputs:
- name: <xref href="System.Object" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Windows LAPS Overview
  href: https://go.microsoft.com/fwlink/?linkid=2233901
syntaxes:
- >-
  Set-LapsADResetPasswordPermission [-Credential <PSCredential>] -Identity <String[]>

   -AllowedPrincipals <String[]> [-Domain <String>] [-DomainController <String>] [-WhatIf] [-Confirm]

   [<CommonParameters>]
examples:
- title: Example 1
  code: |-
    Set-LapsADResetPasswordPermission -Identity LapsTestOU -AllowedPrincipals "Domain Admins"

    Name       DistinguishedName
    ----       -----------------
    LapsTestOU OU=LapsTestOU,DC=laps,DC=com
  description: |-
    This example shows how to run the cmdlet with an isolated name that successfully maps to a
    well-known user or group.
  summary: ""
- title: Example 2
  code: |-
    Set-LapsADResetPasswordPermission -Identity LapsTestOU -AllowedPrincipals @("S-1-5-21-2889755270-1324585639-743026605-1215")

    Name       DistinguishedName
    ----       -----------------
    LapsTestOU OU=LapsTestOU,DC=laps,DC=com
  description: |-
    This example shows how to run the cmdlet specifying a user SID as input.
  summary: ""
- title: Example 3
  code: |-
    Set-LapsADResetPasswordPermission -Identity 'OU=LapsTestOU,DC=laps,DC=com' -AllowedPrincipals @("laps.com\LapsAdmin1", "LapsAdmin2@laps.com")

    Name       DistinguishedName
    ----       -----------------
    LapsTestOU OU=LapsTestOU,DC=laps,DC=com
  description: |-
    This example shows how to run the cmdlet specifying two fully qualified user names in different
    formats.
  summary: ""
- title: Example 4
  code: |-
    Set-LapsADResetPasswordPermission -Identity LapsTestOU -AllowedPrincipals @("LapsAdministratorsGroup")

    Set-LapsADReadPasswordPermission : The 'LapsAdministratorsGroup' account appears to be an isolated
    name but is not a well-known name. Please use a fully qualified name instead, such as
    "LapsAdministratorsGroup@contoso.com" or "contoso\LapsAdministratorsGroup"
    At line:1 char:1
    + Set-LapsADReadPasswordPermission -Identity LapsTestOU -AllowedPrincip ...
    + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        + CategoryInfo          : InvalidArgument: (:) [Set-LapsADReadPasswordPermission], LapsPowershellException
        + FullyQualifiedErrorId : Invalid principal specified,Microsoft.Windows.LAPS.SetLapsADReadPasswordPermission
  description: |-
    This example shows a failure caused by specifying an isolated name that didn't resolve to a
    well-known or built-in account. The fix for this error would be to add a domain name qualifier to
    the input name, for example "LapsAdministratorsGroup@laps.com".
  summary: ""
parameters:
- type: <xref href="System.String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: AllowedPrincipals
  isRequired: true
  description: |+
    Specifies the name of the users or groups should be granted the permissions. Users or groups may be
    specified in either name or SID format. If specified in name format, the name must always include
    the identifying domain name portion unless the name maps to a well-known or built-in account.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: None
  position: Named
  aliases: cf
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.PSCredential" data-throw-if-not-resolved="False" />
  name: Credential
  description: |+
    Specifies the credentials to use when updating AD. If not specified, the current user's credentials
    are used.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Domain
  description: |+
    Specifies the name of the domain to connect to.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: DomainController
  description: |+
    Specifies the name of the domain controller to connect to.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: Identity
  isRequired: true
  description: |+
    Specifies the name of the OU to update.

    This parameter accepts several different name formats that influence the criteria used in the
    resultant AD search. The supported name formats are as follows:

    - distinguishedName (begins with a `CN=`)
    - name (for all other inputs)

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs. The cmdlet isn't run.

  defaultValue: None
  position: Named
  aliases: wi
  parameterValueGroup: ""
uid: LAPS.Set-LapsADResetPasswordPermission
name: Set-LapsADResetPasswordPermission
description: |-
  The `Set-LapsADResetPasswordPermission` cmdlet is used by administrators to configure security
  permissions on an OU to allow specific users or groups to reset the LAPS password expiration time on
  computers in that OU. Users and groups must be fully qualified with both domain and user name
  components. The only exception to this is when the specified name resolves to a built-in principal,
  such as `Domain Admins`.
metadata:
  description: Configures security on an Active Directory (AD) Organizational Unit (OU) to grant specific users or groups permission to set the Windows Local Administrator Password Solution (LAPS) password expiration time.
  external help file: lapspsh.dll-Help.xml
  Module Name: LAPS
  online version: https://learn.microsoft.com/powershell/module/laps/set-lapsadresetpasswordpermission?view=windowsserver2022-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  Locale: en-US
  ms.date: 04/10/2023
  title: Set-LapsADResetPasswordPermission
