### YamlMime:PowershellCmdlet
summary: |-
  Creates a WFP capture provider.
module: NetEventPacketCapture
notes: ""
links:
- text: Get-NetEventWFPCaptureProvider
  href: ./Get-NetEventWFPCaptureProvider.yml
- text: Remove-NetEventWFPCaptureProvider
  href: ./Remove-NetEventWFPCaptureProvider.yml
- text: Set-NetEventWFPCaptureProvider
  href: ./Set-NetEventWFPCaptureProvider.yml
- text: New-NetEventSession
  href: ./New-NetEventSession.yml
syntaxes:
- >-
  Add-NetEventWFPCaptureProvider [-SessionName] <String> [[-Level] <Byte>] [[-MatchAnyKeyword] <UInt64>]

   [[-MatchAllKeyword] <UInt64>] [[-CaptureLayerSet] <WFPCaptureSet>] [[-IPAddresses] <String[]>]

   [[-TCPPorts] <UInt16[]>] [[-UDPPorts] <UInt16[]>] [-CimSession <CimSession[]>] [-ThrottleLimit <Int32>]

   [-AsJob] [-WhatIf] [-Confirm] [<CommonParameters>]
examples:
- title: 'Example 1: Create a WFP capture provider'
  code: |-
    PS C:\>New-NetEventSession -Name "WFPCapture" -CaptureMode RealtimeLocal -LocalFilePath "C:\users\DavidChew\Documents\wfpdata.etl"
    PS C:\> Add-NetEventWFPCaptureProvider -SessionName "WFPCapture" 
    PS C:\> Start-NetEventSession -Name "WFPCapture"
  description: |-
    The first command creates a network event session by using the New-NetEventSession cmdlet.
    The command also assigns the name WFPCapture to the session.

    The second command uses the current cmdlet to create a WFP capture provider for the session named WFPCapture.

    The final command starts the event tracing session named WFPCapture.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsJob
  description: |+
    Runs the cmdlet as a background job. Use this parameter to run commands that take a long time to complete.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="WFPCaptureSet" data-throw-if-not-resolved="False" />
  name: CaptureLayerSet
  description: |+
    Specifies a WFP capture set, which designates the layers and directions to filter.
    The acceptable values for this parameter are:

    - IPv4Inbound 
    - IPv4Outbound 
    - IPv6Inbound 
    - IPv6Outbound

    You can locially OR the direction and IP layer pairs together.
    For instance, you could capture incoming loopback traffic from IPv6 to avoid seeing duplicate traffic received by the loopback interface.

  defaultValue: None
  position: "4"
  aliases: ""
  parameterValueGroup: IPv4Inbound, IPv4Outbound, IPv6Inbound, IPv6Outbound
- type: <xref href="CimSession" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: CimSession
  description: |+
    Runs the cmdlet in a remote session or on a remote computer.
    Enter a computer name or a session object, such as the output of a [New-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227967) or [Get-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227966) cmdlet.
    The default is the current session on the local computer.

  defaultValue: None
  position: Named
  aliases: Session
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: None
  position: Named
  aliases: cf
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: IPAddresses
  description: |+
    Specifies an array of IP addresses.
    The provider filters for and logs network traffic that matches the IP addresses that this parameter specifies.
    The provider joins multiple addresses by using logical ORs.

  defaultValue: None
  position: "5"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Byte" data-throw-if-not-resolved="False" />
  name: Level
  description: |+
    Specifies the Event Tracing for Windows (ETW) event error levels that **NetEventWFPCaptureProvider** returns.
    Use a level of detail specifier as a filter the type of error events that are logged.
    The default value for this parameter is 0x4, for informational events.
    The acceptable values for this parameter are:

    - 0x5.
    Verbose
    - 0x4.
    Informational
    - 0x3.
    Warning
    - 0x2.
    Error
    - 0x1.
    Critical
    - 0x0.
    LogAlways

    The provider must log the event if the value of the event is less than or equal to the value of this parameter.
    Lower level events up to and including the specified level are logged.

  defaultValue: None
  position: "1"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt64" data-throw-if-not-resolved="False" />
  name: MatchAllKeyword
  description: |+
    Specifies a keyword bitmask that restricts the events that the provider logs.

  defaultValue: None
  position: "3"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt64" data-throw-if-not-resolved="False" />
  name: MatchAnyKeyword
  description: |+
    Specifies keywords as a set of hexadecimal values.
    Keywords are flags that you can combine to generate hexadecimal values that enable the provider to write one or more events for which it is instrumented, if a match is found.
    Use a set of hexadecimal values for keywords instead of the keyword names, and apply a filter to write ETW events for keyword matches.
    For more information, see [EnableTraceEx2 function](https://msdn.microsoft.com/en-us/library/windows/desktop/dd392305(v=vs.85)) in the Microsoft Developer Network library.

  defaultValue: None
  position: "2"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: SessionName
  isRequired: true
  description: |+
    Specifies the name of the session that is associated with the **NetEventWFPCaptureProvider**.
    This parameter has the same value as the **Name** parameter for the New-NetEventSession cmdlet.

  defaultValue: None
  position: "0"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt16" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: TCPPorts
  description: |+
    Specifies an array of TCP ports.
    The provider filters for and logs network traffic that matches the ports that this parameter specifies.
    The provider joins multiple port numbers with logical ORs.

  defaultValue: None
  position: "6"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: ThrottleLimit
  description: |+
    Specifies the maximum number of concurrent operations that can be established to run the cmdlet.
    If this parameter is omitted or a value of `0` is entered, then Windows PowerShellÂ® calculates an optimum throttle limit for the cmdlet based on the number of CIM cmdlets that are running on the computer.
    The throttle limit applies only to the current cmdlet, not to the session or to the computer.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt16" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: UDPPorts
  description: |+
    Specifies an array of UDP ports.
    The provider filters for and logs network traffic that matches the ports that this parameter specifies.
    The provider joins multiple port numbers with logical ORs.

  defaultValue: None
  position: "7"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs. The cmdlet is not run.

  defaultValue: None
  position: Named
  aliases: wi
  parameterValueGroup: ""
uid: NetEventPacketCapture.Add-NetEventWFPCaptureProvider
name: Add-NetEventWFPCaptureProvider
description: |-
  The **Add-NetEventWFPCaptureProvider** cmdlet creates a Windows Firewall Platform (WFP) capture provider for network events.
  The WFP captures events directly from the network stack.
  You can capture traffic in network tunnels and from the loopback adapter.
  Unlike a **NetEventPacketCapture** provider, the **NetEventWFPCaptureProvider** captures network traffic above the IP layer.

  A computer typically supports  only one packet capture provider.
  If there is an existing provider on the current computer, remove it before you run this cmdlet.
metadata:
  description: Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell.
  external help file: MSFT_NetEventWFPCaptureProvider.cdxml-help.xml
  Module Name: NetEventPacketCapture
  ms.date: 12/20/2016
  online version: https://docs.microsoft.com/powershell/module/neteventpacketcapture/add-neteventwfpcaptureprovider?view=windowsserver2022-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  title: Add-NetEventWFPCaptureProvider
