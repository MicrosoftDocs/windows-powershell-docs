### YamlMime:PowershellCmdlet
summary: |-
  Create a S2S interface with the specified parameters.
module: RemoteAccess
notes: ""
outputs:
- name: <xref href="Microsoft.Management.Infrastructure.CimInstance#VpnS2SInterface" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Connect-VpnS2SInterface
  href: ./Connect-VpnS2SInterface.yml
- text: Disconnect-VpnS2SInterface
  href: ./Disconnect-VpnS2SInterface.yml
- text: Get-VpnS2SInterface
  href: ./Get-VpnS2SInterface.yml
- text: Remove-VpnS2SInterface
  href: ./Remove-VpnS2SInterface.yml
- text: Set-VpnS2SInterface
  href: ./Set-VpnS2SInterface.yml
- text: Remote Access Cmdlets
  href: ./index.yml
syntaxes:
- >-
  Add-VpnS2SInterface [-Name] <String> [-Protocol <String>] [-Destination] <String[]> [-AdminStatus <Boolean>]

   [-PromoteAlternate <Boolean>] [-AuthenticationMethod <String>] [-PostConnectionIPv4Subnet <String[]>]

   [-PostConnectionIPv6Subnet <String[]>] [-InitiateConfigPayload <Boolean>] [-RadiusAttributeClass <String>]

   [-EnableQoS <EnableQoS>] [-TxBandwidthKbps <UInt64>] [-RxBandwidthKbps <UInt64>]

   [-IPv4TriggerFilter <String[]>] [-IPv6TriggerFilter <String[]>] [-Persistent] [-AutoConnectEnabled <Boolean>]

   [-IPv4TriggerFilterAction <Action>] [-IPv6TriggerFilterAction <Action>]

   [-SADataSizeForRenegotiationKilobytes <UInt32>] [-IPv4Subnet <String[]>] [-IPv6Subnet <String[]>]

   [-ResponderAuthenticationMethod <String>] [-PassThru] [[-RoutingDomain] <String>]

   [-Certificate <X509Certificate2>] [-SharedSecret <String>] [-NetworkOutageTimeSeconds <UInt32>]

   [-NumberOfTries <UInt32>] [-RetryIntervalSeconds <UInt32>] [-SALifeTimeSeconds <UInt32>]

   [-MMSALifeTimeSeconds <UInt32>] [-EapMethod <String>] [-InternalIPv4 <Boolean>] [-InternalIPv6 <Boolean>]

   [-IdleDisconnectSeconds <UInt32>] [-UserName <String>] [-Password <String>] [-SourceIpAddress <String>]

   [-LocalVpnTrafficSelector <CimInstance[]>] [-RemoteVpnTrafficSelector <CimInstance[]>]

   [-EncryptionType <String>] [-CimSession <CimSession[]>] [-ThrottleLimit <Int32>] [-AsJob] [-WhatIf] [-Confirm]

   [<CommonParameters>]
- >-
  Add-VpnS2SInterface [-Name] <String> [-Destination] <String[]> [-AdminStatus <Boolean>]

   [-EnableQoS <EnableQoS>] [-TxBandwidthKbps <UInt64>] [-RxBandwidthKbps <UInt64>] [-IPv4Subnet <String[]>]

   [-IPv6Subnet <String[]>] [-PassThru] [[-RoutingDomain] <String>] [-InternalIPv4 <Boolean>]

   [-InternalIPv6 <Boolean>] -SourceIpAddress <String> [[-GreKey] <UInt32>] [-GreTunnel] [-IPv4Address <String>]

   [-IPv6Address <String>] [-CimSession <CimSession[]>] [-ThrottleLimit <Int32>] [-AsJob] [-WhatIf] [-Confirm]

   [<CommonParameters>]
- >-
  Add-VpnS2SInterface [-Name] <String> [-Protocol <String>] [-Destination] <String[]> [-AdminStatus <Boolean>]

   [-PromoteAlternate <Boolean>] [-AuthenticationMethod <String>] [-PostConnectionIPv4Subnet <String[]>]

   [-PostConnectionIPv6Subnet <String[]>] [-InitiateConfigPayload <Boolean>] [-RadiusAttributeClass <String>]

   [-EnableQoS <EnableQoS>] [-TxBandwidthKbps <UInt64>] [-RxBandwidthKbps <UInt64>]

   [-IPv4TriggerFilter <String[]>] [-IPv6TriggerFilter <String[]>] [-Persistent] [-AutoConnectEnabled <Boolean>]

   [-IPv4TriggerFilterAction <Action>] [-IPv6TriggerFilterAction <Action>]

   [-SADataSizeForRenegotiationKilobytes <UInt32>] [-IPv4Subnet <String[]>] [-IPv6Subnet <String[]>]

   [-ResponderAuthenticationMethod <String>] [-PassThru] [[-RoutingDomain] <String>]

   [-Certificate <X509Certificate2>] [-SharedSecret <String>] [-NetworkOutageTimeSeconds <UInt32>]

   [-NumberOfTries <UInt32>] [-RetryIntervalSeconds <UInt32>] [-SALifeTimeSeconds <UInt32>]

   [-MMSALifeTimeSeconds <UInt32>] [-EapMethod <String>] [-InternalIPv4 <Boolean>] [-InternalIPv6 <Boolean>]

   [-IdleDisconnectSeconds <UInt32>] [-UserName <String>] [-Password <String>] [-CustomPolicy]

   [-EncryptionMethod <EncryptionMethod>] [-IntegrityCheckMethod <IntegrityCheckMethod>]

   [-CipherTransformConstants <CipherTransformConstants>]

   [-AuthenticationTransformConstants <AuthenticationTransformConstants>] [-PfsGroup <PfsGroup>]

   [-DHGroup <DHGroup>] [-SourceIpAddress <String>] [-LocalVpnTrafficSelector <CimInstance[]>]

   [-RemoteVpnTrafficSelector <CimInstance[]>] [-CimSession <CimSession[]>] [-ThrottleLimit <Int32>] [-AsJob]

   [-WhatIf] [-Confirm] [<CommonParameters>]
examples:
- title: 'Example 1: Create a S2S VPN interface'
  code: |-
    PS C:\>Add-VpnS2SInterface -Name "EDGE1" 131.107.0.20 -Protocol IKEv2 -AuthenticationMethod PSKOnly -SharedSecret "ABC" -IPv4Subnet 10.2.0.0/24:100 -IPv6Subnet 2001:db8:2::/48:100
  description: |-
    This command creates a site-to-site VPN interface by name EDGE1 to destination 131.107.0.20. 
    The protocol is IKEv2 and the authentication method is pre-shared key named ABC. 
    Traffic to 10.2.0.0/24 and subnet 2001:db8:2::/48 is sent over this interface if there is no other interface on the server that has same routes with metric less than 100 .
    In case the interface is in disconnected state the connection is triggered if there is no other interface on the server that has same routes with metric less than 100.
  summary: ""
- title: 'Example 2: Create an interface that uses EAP authentication'
  code: |-
    PS C:\>Add-VpnS2SInterface -IPv4Subnet @("131.0.1.0/24:254", "121.0.0.0/16:124") -UserName "abc@contoso.com" -Destination "30.0.0.1" -IPv6Subnet @("3ffe::/32:24", "2ffe::/32:24") -AuthenticationMethod "EAP" -Name "TestVpnS2SInterface" -RetryInterval 120 -EncryptionType "RequireEncryption" -InternalIPv4 1 -InternalIPv6 1 -NumberofTries 20 -AdminStatus $True -IdleDisconnectSeconds 300 -PromoteAlternate $True -Password "1111_aaaa" -PassThru
    Name                 Destination          AdminStatus  ConnectionState IPv4Subnet
    ----                 -----------          -----------  --------------- ----------
    TestVpnS2SInterface  {30.0.0.1}           True         Disconnected    {131.0.1.0/24:254, 121.0.0.0/16:124}
  description: |-
    This command creates an interface that uses EAP authentication method and multiple subnets are routed on this interface 131.0.1.0/24, 121.0.0.0/16.
  summary: ""
- title: 'Example 3: Add an IKEv2 S2S VPN interface'
  code: |-
    PS C:\>Add-VpnS2SInterface -RoutingDomain Rd_001 -Name "Blue-Tunnel-2" -Protocol IKEv2 -Destination 100.0.0.7 -AuthenticationMethod PSKOnly -SharedSecret 111_aaa -Persistent -IPv4Subnet 172.23.90.4/32:100 -PassThru
    RoutingDomain   Name                 Destination          AdminStatus  ConnectionState IPv4Subnet
    -------------   ----                 -----------          -----------  --------------- ----------
    Rd_001          Blue-Tunnel-2        {100.0.0.7}          True         Disconnected    {172.23.90.4/32:100}
  description: |-
    This command adds an IKEv2 S2S VPN (Demand-Dial) interface to the Multi-Tenant Gateway for Routing Domain Rd_001
  summary: ""
- title: 'Example 4: Add a Gre Tunnel interface'
  code: |-
    PS C:\>Add-VpnS2SInterface -GreTunnel -GreKey "1234" -RoutingDomain Rd_001 -Name "Blue-Tunnel-3" -Destination 100.0.0.8 -Persistent -IPv4Subnet 172.23.90.4/32:100 -PassThru
    RoutingDomain   Name                 Destination          AdminStatus  ConnectionState IPv4Subnet
    -------------   ----                 -----------          -----------  --------------- ----------
    Rd_001          Blue-Tunnel-3        {100.0.0.8}          True         Connected    {172.23.90.4/32:100}
  description: |-
    This command adds a Gre Tunnel interface to the Multi-Tenant Gateway for Routing Domain named Rd_001.
  summary: ""
- title: 'Example 5: Add an IKEv2 S2S VPN interface with Traffic Selectors'
  code: |-
    PS C:\>Add-VpnS2SInterface -RoutingDomain Rd_001 -Name "Blue-Tunnel-2" -Protocol IKEv2 -Destination 100.0.0.7 -AuthenticationMethod PSKOnly -SharedSecret 111_aaa -Persistent -IPv4Subnet 172.23.90.4/32:100 -LocalVpnTrafficSelector $localTSObject -RemoteVpnTrafficSelector $RemoteTSObject -PassThru | fl *
    IPv4TriggerFilterAction          : 
    IPv6TriggerFilterAction          : 
    Certificate                      : 
    EnableQoS                        : Enabled
    AdminStatus                      : True
    AuthenticationMethod             : PSKOnly
    ConnectionState                  : Connected
    Destination                      : {100.0.0.7}
    EapMethod                        : 
    IdleDisconnect                   : 500
    InitiateConfigPayload            : True
    InterfaceType                    : FullRouter
    InternalIPv4                     : True
    InternalIPv6                     : True
    IPv4Subnet                       : {172.23.90.4/32:100}
    IPv4TriggerFilter                : 
    IPv6Subnet                       : 
    IPv6TriggerFilter                : 
    LastError                        : 0
    LocalVpnTrafficSelector          : {VpnTrafficSelector}
    MMSALifeTime                     : 28800
    Name                             : Blue-Tunnel-2_9e8ddf33-cadc-48bd-861b-150311c53c9a
    NetworkOutageTime                : 15
    NumberOfTries                    : 3
    Persistent                       : False
    PostConnectionIPv4Subnet         : 
    PostConnectionIPv6Subnet         : 
    PromoteAlternate                 : False
    Protocol                         : Ikev2
    RemoteVpnTrafficSelector         : {VpnTrafficSelector}
    ResponderAuthenticationMethod    : PSKOnly
    RetryInterval                    : 60
    RxBandwidthKbps                  : 0
    SADataSizeForRenegotiation       : 33553408
    SALifeTime                       : 3600
    SourceIpAddress                  : 
    TxBandwidthKbps                  : 0
    UnReachabilityReasons            : 
    UserName                         : 
    RoutingDomain                    : Rd_001_fa3a844e-c397-4004-9c48-547ce397fe59
    PSComputerName                   :
  description: |-
    This command adds an IKEv2 S2S VPN (Demand-Dial) interface to the Multi-Tenant Gateway for Routing Domain Rd_001.
  summary: ""
parameters:
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: AdminStatus
  description: |+
    Specifies the administrator status of the cmdlet.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsJob
  description: |+
    Runs the cmdlet as a background job. Use this parameter to run commands that take a long time to complete.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: AuthenticationMethod
  description: |+
    Specifies the AuthenticationMethod to be used by the S2S connection. 
    If a pre-shared key is specified as authentication method, there can only be one active site to site virtual private network (VPN) interface per destination IP address.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: 'EAP, MachineCertificates, PSKOnly, MSCHAPv2, '
- type: <xref href="AuthenticationTransformConstants" data-throw-if-not-resolved="False" />
  name: AuthenticationTransformConstants
  description: |+
    Specifies the authentication transform plumbed in IPsec policy.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: FirstTransformType, AuthenticationTransformConstant
  parameterValueGroup: MD596, SHA196, SHA256128, GCMAES128, GCMAES192, GCMAES256, None
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: AutoConnectEnabled
  description: |+
    Specifies the activation of auto-reconnection.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="X509Certificate2" data-throw-if-not-resolved="False" />
  name: Certificate
  description: |+
    Specifies the certificate to be used in default store.
    Applicable only if *AuthenticationMethod* is set to MachineCert.

  defaultValue: None
  position: Named
  aliases: Cert
  parameterValueGroup: ""
- type: <xref href="CimSession" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: CimSession
  description: |+
    Runs the cmdlet in a remote session or on a remote computer.
    Enter a computer name or a session object, such as the output of a [New-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227967) or [Get-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227966) cmdlet.
    The default is the current session on the local computer.

  defaultValue: None
  position: Named
  aliases: Session
  parameterValueGroup: ""
- type: <xref href="CipherTransformConstants" data-throw-if-not-resolved="False" />
  name: CipherTransformConstants
  description: |+
    Specifies the cipher plumbed in IPsec policy.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: OtherCipherAlgorithm, FirstCipherAlgorithm, CipherTransformConstant
  parameterValueGroup: DES, DES3, AES128, AES192, AES256, GCMAES128, GCMAES192, GCMAES256, None
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: "False"
  position: Named
  aliases: cf
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: CustomPolicy
  isRequired: true
  description: |+
    Specifies the custom IKE IPsec policy.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: Destination
  isRequired: true
  description: |+
    Specifies the destination end-point of the S2S connection.

  defaultValue: None
  pipelineInput: true
  position: "2"
  aliases: RemoteTunnelEndpoint, RemoteTunnelHostname, RemoteAddress
  parameterValueGroup: ""
- type: <xref href="DHGroup" data-throw-if-not-resolved="False" />
  name: DHGroup
  description: |+
    Specifies the Diffie-Hellman (DH) Group to use during IKE key exchanges.
    Acceptable values for this parameter are: 

    - None
    - Group1
    - Group2
    - Group14
    - ECP256
    - ECP384
    - Group24

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: None, Group1, Group2, Group14, ECP256, ECP384, Group24
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: EapMethod
  description: |+
    Specifies EAP method if *IkeLocalAuthenticationMethod* is EAP.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: 'EAP-TLS, EAP-PEAP, EAP-MSCHAPv2, '
- type: <xref href="EnableQoS" data-throw-if-not-resolved="False" />
  name: EnableQoS
  description: |+
    Indicates whether to enable Quality of Service (QoS) on an interface.
    The acceptable values for this parameter are: 

    - Enabled
    - Disabled

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: Disabled, Enabled
- type: <xref href="EncryptionMethod" data-throw-if-not-resolved="False" />
  name: EncryptionMethod
  description: |+
    Specifies the encryption method in the IKE policy.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: Encryption
  parameterValueGroup: DES, DES3, AES128, AES192, AES256
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: EncryptionType
  description: |+
    Specifies the type of encryption.
    The acceptable values for this parameter are: 

    - NoEncryption
    - RequireEncryption
    - OptionalEncryption
    - MaximumEncryption

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: NoEncryption, RequireEncryption, OptionalEncryption, MaximumEncryption
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: GreKey
  description: |+
    Specifies individual traffic flows within a Generic Routing Encapsulation (GRE) tunnel.

  defaultValue: None
  pipelineInput: true
  position: "4"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: GreTunnel
  isRequired: true
  description: |+
    Indicates whether this cmdlet uses the GRE tunnel capability for the Windows Server Gateway.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: IdleDisconnectSeconds
  description: |+
    Specifies a value that specifies the time, in seconds, after which an idle connection is terminated.
    Unless the idle time-out is disabled, the entire connection is terminated if the connection is idle for the specified interval.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: IdleDurationSeconds, IdleDisconnectSec
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: InitiateConfigPayload
  description: |+
    Indicates whether to initiate configuration payload negotiation.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="IntegrityCheckMethod" data-throw-if-not-resolved="False" />
  name: IntegrityCheckMethod
  description: |+
    Specifies the integrity method plumbed in IPsec policy.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: OtherHashAlgorithm, FirstIntegrityAlgorithm
  parameterValueGroup: MD5, SHA1, SHA256, SHA384
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: InternalIPv4
  description: |+
    Specifies Negotiation of IPv4 Address.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: InternalIPv6
  description: |+
    Specifies negotiation of IPv6 Address.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: IPv4Address
  description: |+
    Indicates whether the cmdlet sets custom IKE IPsec policies.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: IPv4Subnet
  description: |+
    Specifies the IPv4 subnet that is routed on this connection with metric.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: IPv4TriggerSubnet
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: IPv4TriggerFilter
  description: |+
    Specifies a string array of IPv4 filters that trigger demand dial connections.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Action" data-throw-if-not-resolved="False" />
  name: IPv4TriggerFilterAction
  description: |+
    Indicates whether a filter should trigger an S2S connection.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: Allow, Deny
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: IPv6Address
  description: |+
    Indicates whether the cmdlet sets custom IKE IPsec policies.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: IPv6Subnet
  description: |+
    Specifies the IPv6 subnet that is routed on this connection with metric.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: IPv6TriggerSubnet
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: IPv6TriggerFilter
  description: |+
    Specifies an array of IPv6 filters that trigger demand dial connections.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Action" data-throw-if-not-resolved="False" />
  name: IPv6TriggerFilterAction
  description: |+
    Indicates whether a filter should trigger an S2S connection.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: Allow, Deny
- type: <xref href="CimInstance" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: LocalVpnTrafficSelector
  description: |+
    Specifies the initiator Traffic Selector object.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: MMSALifeTimeSeconds
  description: |+
    Specifies the lifetime of main mode security association in seconds, after which the main mode security association is no longer valid.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: MMSaLifeTimeSec
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Name
  isRequired: true
  description: |+
    Specifies the name of the connection.

  defaultValue: None
  pipelineInput: true
  position: "1"
  aliases: ElementName
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: NetworkOutageTimeSeconds
  description: |+
    Specifies the maximum network outage time after which the connection is disconnected.
    Acceptable values for this parameter are: 

    - 6
    - 9
    - 12
    - 15
    - 30
    - 60
    - 120
    - 240
    - 360
    - 720
    - 900

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: NetworkOutageTimeSec
  parameterValueGroup: 3, 6, 9, 12, 15, 30, 60, 120, 240, 360, 720, 900
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: NumberOfTries
  description: |+
    Specifies the number of tries the connection is retried.
    If you specify 0, the cmdlet will retry infinitely.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: PassThru
  description: |+
    Returns an object representing the item with which you are working.
    By default, this cmdlet does not generate any output.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Password
  description: |+
    Specifies the password of the username to be used for dialing the connection.
    Applicable only if *AuthenticationMethod* is set to EAP.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Persistent
  description: |+
    Indicates whether the connection state is persisted across the service restart or system reboots.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="PfsGroup" data-throw-if-not-resolved="False" />
  name: PfsGroup
  description: |+
    Specifies the perfect forward secrecy (PFS) Group plumbed in IPsec policy.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: PfsGroupId
  parameterValueGroup: None, PFS1, PFS2, PFS2048, ECP256, ECP384, PFSMM, PFS24
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: PostConnectionIPv4Subnet
  description: |+
    Specifies the IPv4 subnet routes that are added to a site-to-site interface after the connection is established.
    The values specified are not used to initiate the site-to-site VPN connection.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: PostConnectionIPv6Subnet
  description: |+
    Specifies the IPv6 subnet routes that are added to a site-to-site interface after the connection is established.
    The values specified are not used to initiate the site-to-site VPN connection.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: PromoteAlternate
  description: |+
    Specifies that an alternate IP address that connects successfully becomes the primary IP address, and the current primary IP address is moved to the alternate list.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Protocol
  description: |+
    Specifies the underlying protocol.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: KeyModule
  parameterValueGroup: L2TP, IKEv2, Automatic, SSTP
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: RadiusAttributeClass
  description: |+
    Specifies a RADIUS attribute.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="CimInstance" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: RemoteVpnTrafficSelector
  description: |+
    Specifies the responder traffic selector object.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ResponderAuthenticationMethod
  description: |+
    Specifies the responder AuthenticationMethod to be used by the S2S connection.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: 'MachineCertificates, PSKOnly, '
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: RetryIntervalSeconds
  description: |+
    Number of seconds between retries.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: RetryIntervalSec
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: RoutingDomain
  description: |+
    Specifies an ID, as a string, for a routing domain.
    The ID of a routing domain is a user-defined alphanumeric string.

  defaultValue: None
  pipelineInput: true
  position: "3"
  aliases: RoutingDomainName
  parameterValueGroup: ""
- type: <xref href="UInt64" data-throw-if-not-resolved="False" />
  name: RxBandwidthKbps
  description: |+
    Specifies the receive bandwidth limit, in kilobits per second (Kbps).

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: SADataSizeForRenegotiationKilobytes
  description: |+
    Specifies the number of kilobytes that are allowed to transfer using a security association (SA).
    After that the SA will be renegotiated

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: SaRenegotiationDataSizeKB, LifeTimeKiloBytes
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: SALifeTimeSeconds
  description: |+
    Lifetime of an SA in seconds, after which the SA is no longer valid

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: SaLifeTimeSec, LifeTimeSeconds, QMSALifeTimeSeconds
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: SharedSecret
  description: |+
    Specifies the text of the shared secret to be used in dialing the connection.
    This is only applicable if *AuthenticationMethod* is set to PSK.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: SourceIpAddress
  isRequired: true
  description: |+
    Specifies the source IPv4 or IPv6 addresses to use when dialing the connection.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: ThrottleLimit
  description: |+
    Specifies the maximum number of concurrent connections that can be established to run this command.
    If you omit this parameter or enter a value of 0, the default value, 32, is used.

    The throttle limit applies only to the current command, not to the session or to the computer.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt64" data-throw-if-not-resolved="False" />
  name: TxBandwidthKbps
  description: |+
    Specifies a transmit bandwidth limit, in Kbps, for the interface.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: UserName
  description: |+
    Specifies the username to be used for dialing this connection.
    This is only applicable if the *AuthenticationMethod* parameter is set to EAP.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: User
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs.
    The cmdlet is not run.

  defaultValue: "False"
  position: Named
  aliases: wi
  parameterValueGroup: ""
uid: RemoteAccess.Add-VpnS2SInterface
name: Add-VpnS2SInterface
description: "The **Add-VpnS2SInterface** cmdlet creates a site-to-site (S2S) interface with the specified parameters to customize Internet Protocol security (IPsec) settings.\r\nIf the *Protocol* parameter is set to AutomaticOnly the only authentication method allowed is username.\r\nIf the authentication method is a pre-shared key, only one interface can be enabled per destination and the initiator and responder policies are governed by what is specified per interface.\r\nIf the authentication method is username or machine certificates, only initiator policies are governed by what is specified per interface, responder policies are governed by what is specified on the server. \r\nFor incoming connections: \r\n\r\n  -- If the authentication method is a pre-shared key, the interface whose destination IP matches the incoming IP is activated.\r\n \r\n- If the authentication method is username, the interface whose name matches the username is activated. \r\n- If the authentication method is certificates the interface whose name matches the certificate subject name is activated."
metadata:
  description: Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell.
  external help file: PS_VpnS2SInterface_v1.0.0.cdxml-help.xml
  Module Name: RemoteAccess
  ms.date: 12/20/2016
  online version: https://docs.microsoft.com/powershell/module/remoteaccess/add-vpns2sinterface?view=windowsserver2022-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  title: Add-VpnS2SInterface
