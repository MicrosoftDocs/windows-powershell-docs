### YamlMime:PowershellCmdlet
summary: |-
  Creates a replication partnership between two replication groups.
module: StorageReplica
notes: ""
outputs:
- name: <xref href="replicationgroups" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Get-SRPartnership
  href: ./Get-SRPartnership.yml
- text: New-SRGroup
  href: ./New-SRGroup.yml
- text: Remove-SRPartnership
  href: ./Remove-SRPartnership.yml
- text: Set-SRPartnership
  href: ./Set-SRPartnership.yml
- text: Sync-SRGroup
  href: ./Sync-SRGroup.yml
syntaxes:
- >-
  New-SRPartnership [[-SourceComputerName] <String>] [-SourceRGName] <String> [-DestinationComputerName] <String>

   [-DestinationRGName] <String> [[-ReplicationMode] <ReplicationMode>] [-PreventReplication] [-Seeded]

   [[-AsyncRPO] <UInt32>] [-EnableEncryption] [-Force] [-CimSession <CimSession[]>] [-ThrottleLimit <Int32>]

   [-AsJob] [<CommonParameters>]
- >-
  New-SRPartnership [[-SourceComputerName] <String>] [-SourceRGName] <String> [-SourceVolumeName] <String[]>

   [-SourceLogVolumeName] <String> [[-SourceRGDescription] <String>] [-DestinationComputerName] <String>

   [-DestinationRGName] <String> [-DestinationVolumeName] <String[]> [-DestinationLogVolumeName] <String>

   [[-DestinationRGDescription] <String>] [[-ReplicationMode] <ReplicationMode>] [[-LogSizeInBytes] <UInt64>]

   [-PreventReplication] [-Seeded] [-EnableConsistencyGroups] [[-AsyncRPO] <UInt32>] [-EnableEncryption] [-Force]

   [-CimSession <CimSession[]>] [-ThrottleLimit <Int32>] [-AsJob] [<CommonParameters>]
examples:
- title: 'Example 1: Create a topology between two servers'
  code: |-
    PS C:\>New-SRPartnership -SourceComputerName "SR-SRV05" -SourceRGName "ReplicationGroup01" -SourceVolumeName "D:" -SourceLogVolumeName "E:" -DestinationComputerName "SR-SRV06" -DestinationRGName "ReplicationGroup02" -DestinationVolumeName "D:" -DestinationLogVolumeName "E:"
    DestinationComputerName : SR-SRV06
    DestinationRGName       : ReplicationGroup02
    Id                      : 3767be20-b82f-4c59-8630-116885de1ac7
    SourceComputerName      : SR-SRV05
    SourceRGName            : ReplicationGroup01
    PSComputerName          :
  description: |-
    This command creates a replication topology between servers SR-SRV05 and SR-SRV06.
    The SR-SRV05 server is the source and SR-SRV06 is the destination for the D: volume.
    The E: volume contains the logs for this partnership.
    The log has the default value of 8GB.
    The replication mode has the default value of synchronous.
    The command does not specify seeding, encryption, and consistency groups.
    Replication starts immediately.
  summary: ""
- title: 'Example 2: Pair existing groups'
  code: |-
    This command creates a replication group named ReplicationGroup01 for the server named SR-SRV05 by using the New-SRGroup cmdlet.
    PS C:\>New-SRGroup -ComputerName "SR-SRV05" -Name "ReplicationGroup01" -VolumeName "D:" -LogVolumeName "E:"
    AllowVolumeResize  : False
    AsyncRPO           : 
    ComputerName       : SR-SRV05
    Description        : 
    Id                 : 7b44e4bd-3fd8-411d-a6d1-1a6bb704520f
    IsAutoFailover     : 
    IsCluster          : False
    IsEncrypted        : False
    IsInPartnership    : False
    IsPrimary          : 
    IsSuspended        : 
    IsWriteConsistency : False
    LastInSyncTime     : 
    LogSizeInBytes     : 8589934592
    LogVolume          : e:\ 
    Name               : ReplicationGroup01
    NumOfReplicas      : 1
    Partitions         : {bc49f059-4f78-464d-b88a-3a092108816e}
    Replicas           : {MSFT_WvrReplica (PartitionId =
                         "bc49f059-4f78-464d-b88a-3a092108816e")}
    ReplicationMode    : Synchronous
    ReplicationStatus  : NotInPartnership
    PSComputerName     :

    This command creates a replication group named ReplicationGroup02 for the server named SR-SRV06. 
    PS C:\>New-SRGroup -ComputerName "SR-SRV06" -Name "ReplicationGroup02" -VolumeName "D:" -LogVolumeName "E:"
    AllowVolumeResize  : False
    AsyncRPO           : 
    ComputerName       : SR-SRV06
    Description        : 
    Id                 : c72ad564-6618-4ef2-92c6-13e0cc451303
    IsAutoFailover     : 
    IsCluster          : False
    IsEncrypted        : False
    IsInPartnership    : False
    IsPrimary          : 
    IsSuspended        : 
    IsWriteConsistency : False
    LastInSyncTime     : 
    LogSizeInBytes     : 8589934592
    LogVolume          : e:\ 
    Name               : ReplicationGroup02
    NumOfReplicas      : 1
    Partitions         : {92306c9f-655c-48e2-a28f-f08010514161}
    Replicas           : {MSFT_WvrReplica (PartitionId =
                         "92306c9f-655c-48e2-a28f-f08010514161")}
    ReplicationMode    : Synchronous
    ReplicationStatus  : NotInPartnership
    PSComputerName     :

    This command pairs the replication groups from the previous commands.
    PS C:\>New-SRPartnership -SourceComputerName "SR-SRV05" -SourceRGName "ReplicationGroup01" -DestinationComputerName "SR-SRV06" -DestinationRGName "ReplicationGroup02" 
    DestinationComputerName : SR-SRV06
    DestinationRGName       : ReplicationGroup02
    Id                      : cc9d4af0-c9c0-41e9-b7ae-e184714077ec
    SourceComputerName      : SR-SRV05
    SourceRGName            : ReplicationGroup01
    PSComputerName          :
  description: |-
    This example creates two replication groups separately and then pairs those groups.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsJob
  description: |+
    Runs the cmdlet as a background job. Use this parameter to run commands that take a long time to complete.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="UInt32" data-throw-if-not-resolved="False" />
  name: AsyncRPO
  description: |+
    Specifies the maximum difference in time, in seconds, that data for an asynchronous partnership can be different between source and destination.
    This is a Recovery Point Objective.
    The minimum value is 30 seconds.
    The default value is 5 minutes.

    After exceeding this time, the source server alerts the Health Service on clusters.
    It logs event 1239 in the Storage Replica Admin event log channel.
    If the RPO time is lower than the configured time, event 1240 is logged.

  defaultValue: None
  position: "51"
  aliases: RPO
  parameterValueGroup: ""
- type: <xref href="CimSession" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: CimSession
  description: |+
    Runs the cmdlet in a remote session or on a remote computer.
    Enter a computer name or a session object, such as the output of a [New-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227967) or [Get-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227966) cmdlet.
    The default is the current session on the local computer.

  defaultValue: None
  position: Named
  aliases: Session
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: DestinationComputerName
  isRequired: true
  description: |+
    Specifies a single replica host computer NetBIOS name or fully qualified domain name (FQDN) of the destination computer.

  defaultValue: None
  pipelineInput: true
  position: "2"
  aliases: DCN
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: DestinationLogVolumeName
  isRequired: true
  description: |+
    Specifies a drive letter, mount point path, or volume GUID where Storage Replication creates destination replication logs.
    The volume must contain an NTFS-formatted volume or ReFS-formatted volume.
    The path must exist.
    The path cannot be a mapped drive or UNC path.

    Storage Replication creates logs in the System Volume Information folder.

  defaultValue: None
  pipelineInput: true
  position: "8"
  aliases: DLV
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: DestinationRGDescription
  description: |+
    Specifies a description for the destination replication group.

  defaultValue: None
  position: "9"
  aliases: DGD
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: DestinationRGName
  isRequired: true
  description: |+
    Specifies a name for the destination replication group.

  defaultValue: None
  pipelineInput: true
  position: "3"
  aliases: DGN
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: DestinationVolumeName
  isRequired: true
  description: |+
    Specifies an array of drive letters or mount point paths of partitions for the replica.
    The volumes must exist.
    The volumes cannot be mapped drives or UNC paths.
    You can omit the colon symbol when you specify drive letters.

    This is an ordered list.
    The order of volumes determines the order of replication.

    For instance, to replicate the F: and H: drives on one server to the F: and H: drives of another server, specify the following values: 

    `-SourceVolumeName "F:","H:" -DestinationVolumeName "F:","H:"`

     To replicate F: to H: instead, specify the following values: 

    `-SourceVolumeName "F:","H:" -DestinationVolumeName "H:","F:"`

    We do not recommend replicating different drive letters or mount point paths.
    The practice can cause application failures because of stored settings after a failover occurs.

  defaultValue: None
  pipelineInput: true
  position: "7"
  aliases: DVN
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: EnableConsistencyGroups
  description: |+
    Indicates that consistency groups are enabled for the replication group that contains multiple volumes.
    Consistency groups provide write ordering.
    This can be important, for example, for replication of application data on multiple volumes.
    If you enable consistency groups, it may decrease replication and write Input/Output performance.

  defaultValue: None
  position: "14"
  aliases: EC
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: EnableEncryption
  description: |+
    Indicates that this partnership should encrypt connections by using SMB AES-128-GCM.
    Enabling encryption can protect Storage Replica block transfers from man-in-the-middle interception or reading.
    Enabling encryption decreases replication and write Input/Output performance.

  defaultValue: None
  position: "99"
  aliases: EE
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Force
  description: |+
    Forces the command to run without asking for user confirmation.

  defaultValue: None
  position: "100"
  aliases: F
  parameterValueGroup: ""
- type: <xref href="UInt64" data-throw-if-not-resolved="False" />
  name: LogSizeInBytes
  description: |+
    Specifies the aggregate size of log files on each server in the replication group for the volumes that are associated with this replication group.
    The minimum size 512MB.
    You can specify a value by using the Windows PowerShell byte conversion capability, such as 4GB or 3200MB.
    A value that is too small may cause decreased replication performance or increased recovery time after an interruption between computers.

  defaultValue: None
  position: "11"
  aliases: LS
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: PreventReplication
  description: |+
    Indicates that this cmdlet prevent replication from starting immediately.
    By default, replication starts automatically at the time that you create the partnership.
    To start replication later, use the Sync-SRGroup cmdlet.

  defaultValue: None
  position: "5"
  aliases: P
  parameterValueGroup: ""
- type: <xref href="ReplicationMode" data-throw-if-not-resolved="False" />
  name: ReplicationMode
  description: |+
    Specifies the desired mode of replication for this source and destination pair.
    The acceptable values for this parameter are:

    - Synchronous or 1.
    The synchronous mode requires all writes to commit on the destination server and on the source server, which guarantees data integrity between computers. 
    - Asynchronous or 2. 
    The asynchronous mode writes to the source server without waiting for the destination server, which allows for replication over high latency, geographic networks. 

    The default value is synchronous.

    The default asynchronous recovery point alert time is 5 minutes.
    You can modify it by using the Set-SRPartnership cmdlet.
    The alert time has no effect on replication behavior, only on reporting.

  defaultValue: None
  position: "4"
  aliases: RM
  parameterValueGroup: Synchronous, Asynchronous
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Seeded
  description: |+
    Indicates that the destination server contains a seeded copy of the data from the source server.
    Seeded data is defined as a copy of data from the source server that has a high similarity, such as mostly empty blocks, restoring a recent backup, or shipping cloned copies of disks to the destination server.

    Seeding is most effective when using a previous copy of the storage, such as a split mirror or previously replicated drives, or when the storage is mostly empty and was always empty, such as a recently initialized drive with a newly formatted volume.
    Seeding is somewhat effective with data that came from a backup restore or a complete tree copy of data or from copies of very large files.

    Seeding is least effective when copying large numbers of small files from some random locations to some other random locations.
    Storage Replica automatically uses seeding when it restarts replication after a long outage that wrapped the logs.

  defaultValue: None
  position: "6"
  aliases: S
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: SourceComputerName
  description: |+
    Specifies a single replica host computer NetBIOS name or FQDN of the source computer.
    The default value is the local computer.

  defaultValue: None
  pipelineInput: true
  position: "0"
  aliases: SCN
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: SourceLogVolumeName
  isRequired: true
  description: |+
    Specifies a drive letter, mount point path, or volume GUID where Storage Replication creates source replication logs.
    The volume must contain an NTFS-formatted volume or ReFS-formatted volume.
    The path must exist.
    The path cannot be a mapped drive or UNC path.

    Storage Replication creates logs in the System Volume Information folder.

  defaultValue: None
  pipelineInput: true
  position: "3"
  aliases: SLN
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: SourceRGDescription
  description: |+
    Specifies a description for the source replication group.

  defaultValue: None
  position: "4"
  aliases: SGD
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: SourceRGName
  isRequired: true
  description: |+
    Specifies the name of the source replication group.

  defaultValue: None
  pipelineInput: true
  position: "1"
  aliases: SGN
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: SourceVolumeName
  isRequired: true
  description: |+
    Specifies an array of drive letters or mount point paths of partitions for the replica.
    The volumes must exist.
    The volumes cannot be mapped drives or UNC paths.

    This is an ordered list.
    The order of volumes determines the order of replication.
    For more information, see the *DestinationVolumeName* parameter.

  defaultValue: None
  pipelineInput: true
  position: "2"
  aliases: SVN
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: ThrottleLimit
  description: |+
    Specifies the maximum number of concurrent operations that can be established to run the cmdlet.
    If this parameter is omitted or a value of `0` is entered, then Windows PowerShellÂ® calculates an optimum throttle limit for the cmdlet based on the number of CIM cmdlets that are running on the computer.
    The throttle limit applies only to the current cmdlet, not to the session or to the computer.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
uid: StorageReplica.New-SRPartnership
name: New-SRPartnership
description: |-
  The **New-SRPartnership** cmdlet creates a replication partnership between two new or existing replication groups.
  This cmdlet can create the complete replication topology.
  It can also tie together separately created replication groups.
metadata:
  description: Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell.
  external help file: MSFT_WvrAdminTasks.cdxml-help.xml
  Module Name: StorageReplica
  ms.date: 12/20/2016
  online version: https://docs.microsoft.com/powershell/module/storagereplica/new-srpartnership?view=windowsserver2022-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  title: New-SRPartnership
