### YamlMime:PowershellCmdlet
summary: |-
  Sets the trusted network list.
module: VpnClient
notes: ""
outputs:
- name: <xref href="Microsoft.Management.Infrastructure.CimInstance#VpnConnectionTriggerTrustedNetwork" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Add-VpnConnectionTriggerTrustedNetwork
  href: ./Add-VpnConnectionTriggerTrustedNetwork.yml
- text: Get-VpnConnection
  href: ./Get-VpnConnection.yml
- text: Get-VpnConnectionTrigger
  href: ./Get-VpnConnectionTrigger.yml
- text: Remove-VpnConnectionTriggerTrustedNetwork
  href: ./Remove-VpnConnectionTriggerTrustedNetwork.yml
syntaxes:
- >-
  Set-VpnConnectionTriggerTrustedNetwork [-ConnectionName] <String> [-DefaultDnsSuffixes] [-PassThru] [-Force]

   [-CimSession <CimSession[]>] [-ThrottleLimit <Int32>] [-AsJob] [-WhatIf] [-Confirm] [<CommonParameters>]
examples:
- title: 'Example 1: Set the trusted network list'
  code: |-
    PS C:\>Get-VpnConnectionTrigger -ConnectionName "ContosoVPN"
    PS C:\> Set-VpnConnectionTriggerTrustedNetwork -ConnectionName "ContosoVPN" -DefaultDnsSuffixes -PassThru -Force 
    ConnectionName : Contoso
    DnsSuffix      : {newyork.contoso.com, washington.contoso.com}
  description: |-
    This example sets the trusted network list for a VPN connection profile.

    The first command uses the Get-VpnConnectionTrigger cmdlet to get the trigger properties of a VPN connection named ContosoVPN.

    The second command sets the trusted network list for the VPN connection named ContosoVPN with the DNS suffixes in the NRPT that are configured as part of triggering properties.
    The *DefaultDnsSuffixes* parameter specifies that the server copies all DNS suffixes in the **VpnConnectionTriggerDnsConfiguration** object that have corresponding server addresses into the DNS suffixes for **VpnConnectionTriggerTrustedNetwork**.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsJob
  description: |+
    Runs the cmdlet as a background job. Use this parameter to run commands that take a long time to complete.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="CimSession" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: CimSession
  description: |+
    Runs the cmdlet in a remote session or on a remote computer.
    Enter a computer name or a session object, such as the output of a [New-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227967) or [Get-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227966) cmdlet.
    The default is the current session on the local computer.

  defaultValue: None
  position: Named
  aliases: Session
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: "False"
  position: Named
  aliases: cf
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ConnectionName
  isRequired: true
  description: |+
    Specifies the name of a VPN connection profile.
    To view existing VPN connection profiles, use the Get-VpnConnection cmdlet.

  defaultValue: None
  pipelineInput: true
  position: "1"
  aliases: Name
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: DefaultDnsSuffixes
  isRequired: true
  description: |+
    Indicates that this cmdlet copies all DNS suffixes in the **VpnConnectionTriggerDnsConfiguration** object into the DNS suffixes for **VpnConnectionTriggerTrustedNetwork**.
    This cmdlet does not copy DNS suffixes without corresponding DNS servers.

  defaultValue: None
  pipelineInput: true
  position: "2"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Force
  description: |+
    Indicates that the cmdlet replaces the current trusted network list of with the DNS suffixes in **VpnConnectionTriggerDnsConfiguration** without a confirmation message.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: PassThru
  description: |+
    Returns an object representing the item with which you are working.
    By default, this cmdlet does not generate any output.
    If you specify this parameter, the cmdlet returns the **VpnConnectionTriggerTrustedNetwork** object that contains the list of trusted networks for triggering.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: ThrottleLimit
  description: |+
    Specifies the maximum number of concurrent operations that can be established to run the cmdlet.
    If this parameter is omitted or a value of `0` is entered, then Windows PowerShellÂ® calculates an optimum throttle limit for the cmdlet based on the number of CIM cmdlets that are running on the computer.
    The throttle limit applies only to the current cmdlet, not to the session or to the computer.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs.
    The cmdlet is not run.

  defaultValue: "False"
  position: Named
  aliases: wi
  parameterValueGroup: ""
uid: VpnClient.Set-VpnConnectionTriggerTrustedNetwork
name: Set-VpnConnectionTriggerTrustedNetwork
description: |-
  The **Set-VpnConnectionTriggerTrustedNetwork** cmdlet sets the trusted network list.
  The cmdlet sets the trusted network list with the Domain Name System (DNS) suffixes in the name resolution policy table (NRPT) that are configured as part of triggering properties.
  The cmdlet ignores NRPT exemption entries.
metadata:
  description: Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell.
  external help file: PS_VpnConnectionTriggerTrustedNetwork_v1.0.cdxml-help.xml
  Module Name: VpnClient
  ms.date: 12/20/2016
  online version: https://docs.microsoft.com/powershell/module/vpnclient/set-vpnconnectiontriggertrustednetwork?view=windowsserver2022-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  title: Set-VpnConnectionTriggerTrustedNetwork
