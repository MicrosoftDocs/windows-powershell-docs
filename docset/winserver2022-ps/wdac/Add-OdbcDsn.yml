### YamlMime:PowershellCmdlet
summary: |-
  Adds an ODBC DSN.
module: Wdac
notes: ""
outputs:
- name: <xref href="Microsoft.Management.Infrastructure.CimInstance#MSFT_OdbcDsn" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  description: ""
links:
- text: Get-OdbcDsn
  href: ./Get-OdbcDsn.yml
- text: Remove-OdbcDsn
  href: ./Remove-OdbcDsn.yml
- text: Set-OdbcDsn
  href: ./Set-OdbcDsn.yml
syntaxes:
- >-
  Add-OdbcDsn [-Name] <String> -DriverName <String> [-SetPropertyValue <String[]>] [-PassThru]

   [-Platform <String>] -DsnType <String> [-CimSession <CimSession[]>] [-ThrottleLimit <Int32>] [-AsJob]

   [<CommonParameters>]
examples:
- title: 'Example 1: Add a 32-bit ODBC User DSN'
  code: |-
    PS C:\> Add-OdbcDsn -Name "MyPayroll" -DriverName "Microsoft Access Driver (*.mdb, *.accdb)" -DsnType "User" -Platform "32-bit" -SetPropertyValue 'Dbq=C:\mydatabase.accdb'
  description: |-
    This command adds a 32-bit ODBC User DSN named MyPayroll that uses the specified 32-bit driver with the specified properties.
  summary: ""
- title: 'Example 2: Add an ODBC System DSN'
  code: |-
    PS C:\> Add-OdbcDsn -Name "MyPayroll" -DriverName "SQL Server Native Client 10.0" -DsnType "System" -SetPropertyValue @("Server=MyServer", "Trusted_Connection=Yes", "Database=Payroll")
  description: |-
    This command adds the ODBC System DSNs named MyPayroll that use SQL Server Native Client 10.0 with the specified DSN properties.
    Because the command does not include the *Platform* parameter, the platform architecture is the default, native platform.
  summary: ""
- title: 'Example 3: Add and store an ODBC System DSN'
  code: |-
    PS C:\> $NewDsn = Add-OdbcDsn -Name "MyPayroll" -DriverName "SQL Server Native Client 10.0" -DsnType "System" -SetPropertyValue @("Server=MyServer", "Trusted_Connection=Yes", "Database=Payroll") -PassThru
  description: |-
    This command adds the ODBC System DSNs named MyPayroll that use SQL Server Native Client 10.0 with the specified DSN properties, and then stores the results in the $NewDsn variable.
    The command includes the *PassThru* parameter.
    Without *PassThru*, the cmdlet does not return anything.
  summary: ""
- title: 'Example 4: Migrates DSNs to a newer version of a driver'
  code: |-
    PS C:\> $DsnArray = Get-OdbcDsn -DriverName 'SQL Server Native Client 10.0'
    PS C:\> ForEach ($Dsn in $ DsnArr) {
              Remove-OdbcDsn -InputObject $Dsn 
              # You can change the property array as well, 
              # if DSN attributes have been changed in the new driver version

    PS C:\> Add-OdbcDsn -Name $Dsn.Name -DsnType $Dsn.DsnType -Platform $Dsn.Platform -DriverName 'SQL Server Native Client 12.0' -SetPropertyValue $Dsn.PropertyValue
    }
  description: |-
    The first command gets ODBC data source names by using the Get-OdbcDsn cmdlet, and then stores them in the $DsnArray variable.

    The second command uses the ForEach Windows PowerShell keyword to step through each member of $DsnArray.
    For each member, the command uses the current cmdlet to migrate DSNs using the SQL Server Native Client 10.0 driver to a newer version of that driver.
    This command works for the SQL Server Native Client ODBC driver.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsJob
  description: |+
    Runs the cmdlet as a background job. Use this parameter to run commands that take a long time to complete.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="CimSession" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: CimSession
  description: |+
    Runs the cmdlet in a remote session or on a remote computer.
    Enter a computer name or a session object, such as the output of a [New-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227967) or [Get-CimSession](https://go.microsoft.com/fwlink/p/?LinkId=227966) cmdlet.
    The default is the current session on the local computer.

  defaultValue: None
  position: Named
  aliases: Session
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: DriverName
  isRequired: true
  description: |+
    Specifies the name of a driver.
    This cmdlet assigns the new ODBC DSN to the driver that this parameter specifies.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: DsnType
  isRequired: true
  description: |+
    Specifies the type of an ODBC DSN.
    This cmdlet adds a DSN of the type that this parameter specifies.
    The acceptable values for this parameter are:

    - User
    - System

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: User, System
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Name
  isRequired: true
  description: |+
    Specifies the name of an ODBC DSN.
    This cmdlet creates a DSN that has the name that this parameter specifies.

  defaultValue: None
  pipelineInput: true
  position: "0"
  aliases: DsnName
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: PassThru
  description: |+
    Returns an object representing the item with which you are working.
    By default, this cmdlet does not generate any output.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Platform
  description: |+
    Specifies the platform architecture.
    This cmdlet adds an ODBC DSN that belongs to the platform that this parameter specifies.
    The acceptable values for this parameter are:

    - 32-bit
    - 64-bit

    The default value is 32-bit on a 32-bit process.
    The default value is 64-bit on a 64-bit process.
    If you run this cmdlet in a remote Common Information Model (CIM) session, this parameter refers to the platform architecture on the remote computer.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: 32-bit, 64-bit
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: SetPropertyValue
  description: |+
    Specifies an array of property values.
    This cmdlet specifies these property values for the ODBC DSN.
    Specify an array of strings of the form \<key\>=\<value\>.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: ThrottleLimit
  description: |+
    Specifies the maximum number of concurrent operations that can be established to run the cmdlet.
    If this parameter is omitted or a value of `0` is entered, then Windows PowerShellÂ® calculates an optimum throttle limit for the cmdlet based on the number of CIM cmdlets that are running on the computer.
    The throttle limit applies only to the current cmdlet, not to the session or to the computer.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
uid: Wdac.Add-OdbcDsn
name: Add-OdbcDsn
description: |-
  The **Add-OdbcDsn** cmdlet adds an Open Database Connectivity (ODBC) data source name (DSN) to the computer.
  You can specify the properties of the DSN by using the *SetPropertyValue* parameter.

  Do not use the Set-OdbcDsn cmdlet to add a new DSN.

  For more information about ODBC, data source names, and drivers, see [Microsoft Open Database Connectivity (ODBC)](https://msdn.microsoft.com/en-us/library/ms710252.aspx), [Data Sources](https://msdn.microsoft.com/en-us/library/ms711688.aspx), and [Drivers](https://msdn.microsoft.com/en-us/library/ms715383.aspx) on the Microsoft Developer Network.
metadata:
  description: Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell.
  external help file: MSFT_OdbcDsnTask_v1.0.cdxml-help.xml
  Module Name: Wdac
  ms.date: 12/20/2016
  online version: https://docs.microsoft.com/powershell/module/wdac/add-odbcdsn?view=windowsserver2022-ps&wt.mc_id=ps-gethelp
  schema: 2.0.0
  title: Add-OdbcDsn
